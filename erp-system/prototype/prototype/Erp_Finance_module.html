<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ERP Finance Module - Complete Working System</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/luxon@3.3.0/build/global/luxon.min.js"></script>
    <style>
        :root {
            --primary: #1a237e;
            --secondary: #283593;
            --accent: #3949ab;
            --success: #2e7d32;
            --warning: #f57c00;
            --danger: #d32f2f;
            --info: #0288d1;
            --light: #f5f5f5;
            --dark: #212121;
            --sidebar-width: 280px;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        body {
            background: #f0f2f5;
            color: #333;
            display: flex;
            min-height: 100vh;
            overflow-x: hidden;
        }

        /* Sidebar */
        .sidebar {
            width: var(--sidebar-width);
            background: linear-gradient(180deg, var(--primary) 0%, #0d1b6b 100%);
            color: white;
            height: 100vh;
            position: fixed;
            overflow-y: auto;
            transition: transform 0.3s;
            z-index: 1000;
            box-shadow: 3px 0 15px rgba(0,0,0,0.1);
        }

        .sidebar-header {
            padding: 25px 20px;
            text-align: center;
            border-bottom: 1px solid rgba(255,255,255,0.1);
            background: rgba(0,0,0,0.1);
        }

        .sidebar-header h2 {
            font-size: 1.4rem;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 12px;
            font-weight: 600;
        }

        .sidebar-menu {
            list-style: none;
            padding: 20px 0;
        }

        .sidebar-menu li {
            margin-bottom: 2px;
        }

        .sidebar-menu a {
            color: rgba(255,255,255,0.9);
            text-decoration: none;
            display: flex;
            align-items: center;
            padding: 14px 25px;
            transition: all 0.3s;
            font-weight: 500;
            position: relative;
            overflow: hidden;
        }

        .sidebar-menu a:hover {
            background: rgba(255,255,255,0.1);
            color: white;
            padding-left: 30px;
        }

        .sidebar-menu a.active {
            background: var(--accent);
            color: white;
            border-left: 4px solid #00bcd4;
            box-shadow: inset 0 0 20px rgba(0,0,0,0.1);
        }

        .sidebar-menu a.active:before {
            content: '';
            position: absolute;
            left: 0;
            top: 0;
            height: 100%;
            width: 4px;
            background: #00bcd4;
        }

        .sidebar-menu i {
            width: 25px;
            margin-right: 15px;
            font-size: 1.1rem;
        }

        .badge {
            padding: 3px 8px;
            border-radius: 12px;
            font-size: 0.75rem;
            font-weight: 600;
            margin-left: auto;
        }

        .badge.new {
            background: #ff4081;
            color: white;
        }

        /* Main Content */
        .main-content {
            flex: 1;
            margin-left: var(--sidebar-width);
            padding: 0;
            transition: margin-left 0.3s;
            min-height: 100vh;
        }

        /* Topbar */
        .topbar {
            background: white;
            padding: 0 30px;
            height: 70px;
            display: flex;
            align-items: center;
            justify-content: space-between;
            box-shadow: 0 2px 10px rgba(0,0,0,0.05);
            position: sticky;
            top: 0;
            z-index: 100;
        }

        .page-title {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .page-title h1 {
            color: var(--primary);
            font-size: 1.8rem;
            font-weight: 600;
        }

        .page-title .subtitle {
            color: #666;
            font-size: 0.9rem;
            background: #f0f2f5;
            padding: 4px 12px;
            border-radius: 20px;
        }

        .user-actions {
            display: flex;
            align-items: center;
            gap: 20px;
        }

        .notification {
            position: relative;
            cursor: pointer;
        }

        .notification-badge {
            position: absolute;
            top: -5px;
            right: -5px;
            background: var(--danger);
            color: white;
            border-radius: 50%;
            width: 18px;
            height: 18px;
            font-size: 0.7rem;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .user-profile {
            display: flex;
            align-items: center;
            gap: 12px;
            cursor: pointer;
            padding: 8px 15px;
            border-radius: 30px;
            transition: background 0.3s;
        }

        .user-profile:hover {
            background: #f5f5f5;
        }

        .user-avatar {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: var(--accent);
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: 600;
        }

        .user-info h4 {
            font-weight: 600;
            color: #333;
        }

        .user-info p {
            font-size: 0.85rem;
            color: #666;
        }

        /* Content Area */
        .content-area {
            padding: 30px;
        }

        /* Cards */
        .cards-container {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 25px;
            margin-bottom: 40px;
        }

        .card {
            background: white;
            border-radius: 12px;
            padding: 25px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.05);
            transition: all 0.3s;
            border: 1px solid #eee;
        }

        .card:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 25px rgba(0,0,0,0.1);
        }

        .card-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 1px solid #eee;
        }

        .card-title {
            font-weight: 600;
            color: var(--dark);
            font-size: 1.1rem;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .card-value {
            font-size: 2rem;
            font-weight: 700;
            color: var(--primary);
            margin: 15px 0;
        }

        .card-trend {
            display: flex;
            align-items: center;
            font-size: 0.9rem;
            gap: 5px;
        }

        .card-trend.positive {
            color: var(--success);
        }

        .card-trend.negative {
            color: var(--danger);
        }

        /* Module Sections */
        .module-section {
            background: white;
            border-radius: 12px;
            padding: 30px;
            margin-bottom: 30px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.05);
        }

        .section-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 25px;
            padding-bottom: 20px;
            border-bottom: 2px solid #f0f0f0;
        }

        .section-title {
            font-size: 1.5rem;
            color: var(--primary);
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .section-actions {
            display: flex;
            gap: 10px;
        }

        /* Buttons */
        .btn {
            padding: 12px 24px;
            border: none;
            border-radius: 8px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            display: inline-flex;
            align-items: center;
            gap: 10px;
            font-size: 0.95rem;
        }

        .btn-sm {
            padding: 8px 16px;
            font-size: 0.85rem;
        }

        .btn-primary {
            background: var(--primary);
            color: white;
        }

        .btn-primary:hover {
            background: var(--secondary);
            transform: translateY(-2px);
        }

        .btn-success {
            background: var(--success);
            color: white;
        }

        .btn-warning {
            background: var(--warning);
            color: white;
        }

        .btn-danger {
            background: var(--danger);
            color: white;
        }

        .btn-info {
            background: var(--info);
            color: white;
        }

        .btn-outline {
            background: transparent;
            color: var(--primary);
            border: 2px solid var(--primary);
        }

        .btn-outline:hover {
            background: var(--primary);
            color: white;
        }

        /* Tables */
        .table-container {
            overflow-x: auto;
            border-radius: 8px;
            border: 1px solid #eee;
        }

        table {
            width: 100%;
            border-collapse: collapse;
        }

        th {
            background: #f8f9fa;
            padding: 18px 20px;
            text-align: left;
            font-weight: 600;
            color: var(--dark);
            border-bottom: 2px solid #e0e0e0;
            white-space: nowrap;
        }

        td {
            padding: 16px 20px;
            border-bottom: 1px solid #eee;
            vertical-align: middle;
        }

        tr:hover {
            background: #f9f9f9;
        }

        .badge {
            padding: 6px 12px;
            border-radius: 20px;
            font-size: 0.8rem;
            font-weight: 600;
        }

        .badge-success {
            background: #e8f5e9;
            color: var(--success);
        }

        .badge-warning {
            background: #fff3e0;
            color: var(--warning);
        }

        .badge-danger {
            background: #ffebee;
            color: var(--danger);
        }

        .badge-info {
            background: #e3f2fd;
            color: var(--info);
        }

        .badge-primary {
            background: #e8eaf6;
            color: var(--primary);
        }

        /* Forms */
        .form-group {
            margin-bottom: 25px;
        }

        .form-row {
            display: flex;
            gap: 20px;
            margin-bottom: 25px;
        }

        .form-row .form-group {
            flex: 1;
            margin-bottom: 0;
        }

        .form-label {
            display: block;
            margin-bottom: 10px;
            font-weight: 500;
            color: #555;
        }

        .form-control {
            width: 100%;
            padding: 14px 18px;
            border: 1px solid #ddd;
            border-radius: 8px;
            font-size: 1rem;
            transition: all 0.3s;
        }

        .form-control:focus {
            border-color: var(--accent);
            outline: none;
            box-shadow: 0 0 0 3px rgba(57, 73, 171, 0.1);
        }

        /* Tabs */
        .tabs {
            display: flex;
            border-bottom: 2px solid #eee;
            margin-bottom: 25px;
            overflow-x: auto;
        }

        .tab {
            padding: 15px 25px;
            font-weight: 600;
            color: #666;
            cursor: pointer;
            border-bottom: 3px solid transparent;
            white-space: nowrap;
            transition: all 0.3s;
        }

        .tab:hover {
            color: var(--primary);
        }

        .tab.active {
            color: var(--primary);
            border-bottom-color: var(--primary);
            background: rgba(57, 73, 171, 0.05);
        }

        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
        }

        /* Modals */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.5);
            z-index: 2000;
            justify-content: center;
            align-items: center;
            backdrop-filter: blur(3px);
        }

        .modal.active {
            display: flex;
        }

        .modal-content {
            background: white;
            border-radius: 15px;
            width: 90%;
            max-width: 800px;
            max-height: 90vh;
            overflow-y: auto;
            animation: modalSlideIn 0.3s ease;
        }

        @keyframes modalSlideIn {
            from {
                opacity: 0;
                transform: translateY(-50px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .modal-header {
            padding: 25px 30px;
            border-bottom: 1px solid #eee;
            display: flex;
            justify-content: space-between;
            align-items: center;
            background: linear-gradient(to right, #f8f9fa, white);
        }

        .modal-body {
            padding: 30px;
        }

        .modal-footer {
            padding: 20px 30px;
            border-top: 1px solid #eee;
            display: flex;
            justify-content: flex-end;
            gap: 15px;
            background: #f9f9f9;
            border-radius: 0 0 15px 15px;
        }

        .close-btn {
            background: none;
            border: none;
            font-size: 1.8rem;
            cursor: pointer;
            color: #999;
            width: 40px;
            height: 40px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 50%;
            transition: background 0.3s;
        }

        .close-btn:hover {
            background: #f5f5f5;
            color: #333;
        }

        /* Charts */
        .chart-container {
            height: 350px;
            margin: 25px 0;
            position: relative;
        }

        /* Workflow Steps */
        .workflow-steps {
            display: flex;
            justify-content: space-between;
            margin: 40px 0;
            position: relative;
            padding: 0 20px;
        }

        .workflow-steps:before {
            content: '';
            position: absolute;
            top: 20px;
            left: 10%;
            right: 10%;
            height: 3px;
            background: #e0e0e0;
            z-index: 1;
        }

        .step {
            background: white;
            border-radius: 50%;
            width: 45px;
            height: 45px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            color: #999;
            border: 3px solid #e0e0e0;
            position: relative;
            z-index: 2;
            transition: all 0.3s;
        }

        .step.active {
            border-color: var(--primary);
            color: var(--primary);
            background: #e8eaf6;
            transform: scale(1.1);
        }

        .step.completed {
            border-color: var(--success);
            color: var(--success);
            background: #e8f5e9;
        }

        .step-label {
            position: absolute;
            top: 60px;
            left: 50%;
            transform: translateX(-50%);
            white-space: nowrap;
            font-size: 0.85rem;
            color: #666;
            font-weight: 500;
        }

        /* Toggle Sidebar Button */
        .toggle-sidebar {
            display: none;
            position: fixed;
            top: 20px;
            left: 20px;
            z-index: 1001;
            background: var(--primary);
            color: white;
            border: none;
            width: 50px;
            height: 50px;
            border-radius: 10px;
            justify-content: center;
            align-items: center;
            font-size: 1.5rem;
            cursor: pointer;
            box-shadow: 0 4px 15px rgba(0,0,0,0.2);
        }

        /* Additional Styles for New Modules */
        .search-filter {
            display: flex;
            gap: 15px;
            margin-bottom: 25px;
            align-items: center;
        }

        .search-box {
            position: relative;
            flex: 1;
        }

        .search-box i {
            position: absolute;
            left: 15px;
            top: 50%;
            transform: translateY(-50%);
            color: #666;
        }

        .search-box input {
            padding-left: 45px;
        }

        .filter-dropdown {
            width: 200px;
        }

        .bank-card {
            background: white;
            border-radius: 12px;
            padding: 25px;
            border: 1px solid #eee;
            margin-bottom: 20px;
        }

        .form-check {
            margin-bottom: 10px;
        }

        .form-check-input {
            margin-right: 10px;
        }

        .domain-comparison {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 25px;
            margin-top: 25px;
        }

        .domain-card {
            background: white;
            border-radius: 12px;
            padding: 25px;
            border: 1px solid #eee;
        }

        .domain-card h3 {
            color: var(--primary);
            margin-bottom: 15px;
        }

        .domain-card p {
            margin-bottom: 10px;
            color: #555;
        }

        .report-card {
            min-height: 200px;
        }

        .report-card p {
            color: #666;
            margin-bottom: 15px;
        }

        /* Responsive */
        @media (max-width: 1200px) {
            .sidebar {
                transform: translateX(-100%);
            }
            .sidebar.active {
                transform: translateX(0);
            }
            .main-content {
                margin-left: 0;
            }
            .toggle-sidebar {
                display: flex;
            }
        }

        @media (max-width: 768px) {
            .content-area {
                padding: 15px;
            }
            .cards-container {
                grid-template-columns: 1fr;
            }
            .form-row {
                flex-direction: column;
                gap: 0;
            }
            .search-filter {
                flex-direction: column;
            }
            .search-box, .filter-dropdown {
                width: 100%;
            }
        }
    </style>
</head>
<body>
    <!-- Toggle Sidebar Button -->
    <button class="toggle-sidebar" id="toggleSidebar">
        <i class="fas fa-bars"></i>
    </button>

    <!-- Sidebar -->
    <nav class="sidebar" id="sidebar">
        <div class="sidebar-header">
            <h2><i class="fas fa-calculator"></i> ERP Finance</h2>
        </div>
        <ul class="sidebar-menu">
            <li><a href="#" class="active" data-page="dashboard"><i class="fas fa-home"></i> Dashboard</a></li>
            <li><a href="#" data-page="coa"><i class="fas fa-list-alt"></i> Chart of Accounts</a></li>
            <li><a href="#" data-page="gl"><i class="fas fa-book"></i> General Ledger</a></li>
            <li><a href="#" data-page="ap"><i class="fas fa-file-invoice-dollar"></i> Accounts Payable <span class="badge new">5</span></a></li>
            <li><a href="#" data-page="ar"><i class="fas fa-hand-holding-usd"></i> Accounts Receivable <span class="badge new">12</span></a></li>
            <li><a href="#" data-page="assets"><i class="fas fa-building"></i> Fixed Assets</a></li>
            <li><a href="#" data-page="bank"><i class="fas fa-university"></i> Bank & Reconciliation</a></li>
            <li><a href="#" data-page="budget"><i class="fas fa-chart-line"></i> Budgeting</a></li>
            <li><a href="#" data-page="reports"><i class="fas fa-chart-bar"></i> Financial Reports</a></li>
            <li><a href="#" data-page="users"><i class="fas fa-users-cog"></i> User Management</a></li>
            <li><a href="#" data-page="setup"><i class="fas fa-cogs"></i> Module Setup</a></li>
            <li><a href="#" data-page="comparison"><i class="fas fa-columns"></i> Domain Comparison</a></li>
        </ul>
    </nav>

    <!-- Main Content -->
    <main class="main-content" id="mainContent">
        <!-- Top Bar -->
        <div class="topbar">
            <div class="page-title">
                <h1 id="pageTitle">Finance Dashboard</h1>
                <div class="subtitle" id="domainBadge">General Business</div>
            </div>
            <div class="user-actions">
                <div class="notification" onclick="toggleNotifications()">
                    <i class="fas fa-bell" style="font-size: 1.3rem; color: #666;"></i>
                    <span class="notification-badge">3</span>
                </div>
                <select class="form-control filter-dropdown" id="domainSelector" style="width: 180px;" onchange="changeDomain(this.value)">
                    <option value="general">General Business</option>
                    <option value="hotel">Hotel Industry</option>
                    <option value="education">Education Sector</option>
                    <option value="banking">Banking</option>
                    <option value="manufacturing">Manufacturing</option>
                </select>
                <div class="user-profile" onclick="showUserMenu()">
                    <div class="user-avatar">
                        <span id="userInitials">AD</span>
                    </div>
                    <div class="user-info">
                        <h4 id="userName">Admin User</h4>
                        <p id="userRole">System Administrator</p>
                    </div>
                    <i class="fas fa-chevron-down"></i>
                </div>
            </div>
        </div>

        <!-- Content Area -->
        <div class="content-area">
            <!-- Dashboard -->
            <div id="dashboardContent" class="page-content active">
                <div class="cards-container">
                    <div class="card">
                        <div class="card-header">
                            <div class="card-title"><i class="fas fa-dollar-sign"></i> Total Revenue</div>
                            <i class="fas fa-chart-line" style="color: var(--success);"></i>
                        </div>
                        <div class="card-value" id="totalRevenue">$ 245,830</div>
                        <div class="card-trend positive">
                            <i class="fas fa-arrow-up"></i> 12.5% vs last month
                        </div>
                    </div>
                    <div class="card">
                        <div class="card-header">
                            <div class="card-title"><i class="fas fa-file-invoice"></i> Accounts Receivable</div>
                            <i class="fas fa-exclamation-circle" style="color: var(--warning);"></i>
                        </div>
                        <div class="card-value" id="totalAR">$ 42,560</div>
                        <div class="card-trend negative">
                            <i class="fas fa-arrow-up"></i> 8.2% overdue
                        </div>
                    </div>
                    <div class="card">
                        <div class="card-header">
                            <div class="card-title"><i class="fas fa-file-invoice-dollar"></i> Accounts Payable</div>
                            <i class="fas fa-clock" style="color: var(--danger);"></i>
                        </div>
                        <div class="card-value" id="totalAP">$ 28,750</div>
                        <div class="card-trend positive">
                            <i class="fas fa-arrow-down"></i> 15.3% decrease
                        </div>
                    </div>
                    <div class="card">
                        <div class="card-header">
                            <div class="card-title"><i class="fas fa-university"></i> Cash Balance</div>
                            <i class="fas fa-piggy-bank" style="color: var(--primary);"></i>
                        </div>
                        <div class="card-value" id="cashBalance">$ 125,420</div>
                        <div class="card-trend positive">
                            <i class="fas fa-arrow-up"></i> 5.8% increase
                        </div>
                    </div>
                </div>

                <div class="module-section">
                    <div class="section-header">
                        <h2 class="section-title"><i class="fas fa-chart-line"></i> Financial Overview</h2>
                        <div class="section-actions">
                            <select class="form-control" id="chartPeriod" style="width: 150px;" onchange="updateFinancialChart()">
                                <option value="30">Last 30 Days</option>
                                <option value="90">Last Quarter</option>
                                <option value="365" selected>Last Year</option>
                                <option value="ytd">Year to Date</option>
                            </select>
                        </div>
                    </div>
                    <div class="chart-container">
                        <canvas id="financialChart"></canvas>
                    </div>
                </div>

                <div class="module-section">
                    <div class="section-header">
                        <h2 class="section-title"><i class="fas fa-tasks"></i> Pending Actions</h2>
                        <button class="btn btn-primary" onclick="markAllComplete()">Mark All Complete</button>
                    </div>
                    <div class="table-container">
                        <table>
                            <thead>
                                <tr>
                                    <th>Action</th>
                                    <th>Module</th>
                                    <th>Priority</th>
                                    <th>Due Date</th>
                                    <th>Status</th>
                                    <th>Actions</th>
                                </tr>
                            </thead>
                            <tbody id="pendingActions"></tbody>
                        </table>
                    </div>
                </div>
            </div>

            <!-- Chart of Accounts -->
            <div id="coaContent" class="page-content" style="display: none;">
                <div class="module-section">
                    <div class="section-header">
                        <h2 class="section-title"><i class="fas fa-list-alt"></i> Chart of Accounts</h2>
                        <div class="section-actions">
                            <button class="btn btn-primary" onclick="showModal('addAccountModal')"><i class="fas fa-plus"></i> Add Account</button>
                            <button class="btn btn-success" onclick="exportCOA()"><i class="fas fa-file-export"></i> Export</button>
                            <button class="btn btn-info" onclick="loadSampleCOA()"><i class="fas fa-download"></i> Load Sample</button>
                        </div>
                    </div>
                    
                    <div class="search-filter">
                        <div class="search-box">
                            <i class="fas fa-search"></i>
                            <input type="text" class="form-control" id="coaSearch" placeholder="Search accounts..." onkeyup="searchCOA()">
                        </div>
                        <select class="form-control filter-dropdown" id="coaTypeFilter" onchange="filterCOA()">
                            <option value="all">All Types</option>
                            <option value="Asset">Asset</option>
                            <option value="Liability">Liability</option>
                            <option value="Equity">Equity</option>
                            <option value="Revenue">Revenue</option>
                            <option value="Expense">Expense</option>
                        </select>
                        <select class="form-control filter-dropdown" id="coaStatusFilter" onchange="filterCOA()">
                            <option value="all">All Status</option>
                            <option value="Active">Active</option>
                            <option value="Inactive">Inactive</option>
                        </select>
                    </div>
                    
                    <div class="tabs">
                        <div class="tab active" data-tab="accounts">Accounts List</div>
                        <div class="tab" data-tab="hierarchy">Account Hierarchy</div>
                        <div class="tab" data-tab="balances">Account Balances</div>
                    </div>

                    <div class="tab-content active" id="accountsTab">
                        <div class="table-container">
                            <table>
                                <thead>
                                    <tr>
                                        <th>Account Code</th>
                                        <th>Account Name</th>
                                        <th>Type</th>
                                        <th>Sub-Type</th>
                                        <th>Balance</th>
                                        <th>Status</th>
                                        <th>Actions</th>
                                    </tr>
                                </thead>
                                <tbody id="coaTable"></tbody>
                            </table>
                        </div>
                    </div>

                    <div class="tab-content" id="hierarchyTab">
                        <div class="bank-card">
                            <h3>Account Hierarchy</h3>
                            <div id="coaHierarchy"></div>
                        </div>
                    </div>

                    <div class="tab-content" id="balancesTab">
                        <div class="chart-container">
                            <canvas id="coaBalanceChart"></canvas>
                        </div>
                        <div class="table-container">
                            <table>
                                <thead>
                                    <tr>
                                        <th>Account Type</th>
                                        <th>Number of Accounts</th>
                                        <th>Total Balance</th>
                                        <th>Percentage</th>
                                    </tr>
                                </thead>
                                <tbody id="coaBalancesTable"></tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>

            <!-- General Ledger -->
            <div id="glContent" class="page-content" style="display: none;">
                <div class="module-section">
                    <div class="section-header">
                        <h2 class="section-title"><i class="fas fa-book"></i> General Ledger</h2>
                        <div class="section-actions">
                            <button class="btn btn-primary" onclick="showModal('journalEntryModal')"><i class="fas fa-plus"></i> Add Journal Entry</button>
                            <button class="btn btn-success" onclick="postAllEntries()"><i class="fas fa-check-circle"></i> Post All Entries</button>
                            <button class="btn btn-info" onclick="runMonthEndClose()"><i class="fas fa-calendar-check"></i> Month-End Close</button>
                        </div>
                    </div>
                    
                    <div class="cards-container">
                        <div class="card">
                            <div class="card-header">
                                <div class="card-title">Total Journal Entries</div>
                                <i class="fas fa-file-alt" style="color: var(--primary);"></i>
                            </div>
                            <div class="card-value"><span id="totalJournals">0</span></div>
                        </div>
                        <div class="card">
                            <div class="card-header">
                                <div class="card-title">Unposted Entries</div>
                                <i class="fas fa-clock" style="color: var(--warning);"></i>
                            </div>
                            <div class="card-value"><span id="unpostedJournals">0</span></div>
                        </div>
                        <div class="card">
                            <div class="card-header">
                                <div class="card-title">This Month</div>
                                <i class="fas fa-calendar-alt" style="color: var(--info);"></i>
                            </div>
                            <div class="card-value"><span id="monthJournals">0</span></div>
                        </div>
                        <div class="card">
                            <div class="card-header">
                                <div class="card-title">Debit/Credit Balance</div>
                                <i class="fas fa-balance-scale" style="color: var(--success);"></i>
                            </div>
                            <div class="card-value" style="font-size: 1.5rem;"><span id="debitCreditBalance">$0.00</span></div>
                        </div>
                    </div>

                    <div class="workflow-steps">
                        <div class="step completed" id="step1">
                            <i class="fas fa-plus"></i>
                            <div class="step-label">Create Entry</div>
                        </div>
                        <div class="step active" id="step2">
                            <i class="fas fa-eye"></i>
                            <div class="step-label">Review</div>
                        </div>
                        <div class="step" id="step3">
                            <i class="fas fa-check"></i>
                            <div class="step-label">Approve</div>
                        </div>
                        <div class="step" id="step4">
                            <i class="fas fa-book"></i>
                            <div class="step-label">Post to GL</div>
                        </div>
                    </div>

                    <div class="tabs">
                        <div class="tab active" data-tab="journals">Journal Entries</div>
                        <div class="tab" data-tab="trialbalance">Trial Balance</div>
                        <div class="tab" data-tab="ledger">Ledger Details</div>
                        <div class="tab" data-tab="closing">Period Closing</div>
                    </div>

                    <div class="tab-content active" id="journalsTab">
                        <div class="search-filter">
                            <div class="search-box">
                                <i class="fas fa-search"></i>
                                <input type="text" class="form-control" id="journalSearch" placeholder="Search journal entries..." onkeyup="searchJournals()">
                            </div>
                            <select class="form-control filter-dropdown" id="journalStatusFilter" onchange="filterJournals()">
                                <option value="all">All Status</option>
                                <option value="Draft">Draft</option>
                                <option value="Pending">Pending</option>
                                <option value="Posted">Posted</option>
                            </select>
                            <input type="date" class="form-control filter-dropdown" id="journalDateFilter" onchange="filterJournals()">
                        </div>
                        
                        <div class="table-container">
                            <table>
                                <thead>
                                    <tr>
                                        <th>Date</th>
                                        <th>Journal No.</th>
                                        <th>Description</th>
                                        <th>Debit Total</th>
                                        <th>Credit Total</th>
                                        <th>Status</th>
                                        <th>Actions</th>
                                    </tr>
                                </thead>
                                <tbody id="journalTable"></tbody>
                            </table>
                        </div>
                    </div>

                    <div class="tab-content" id="trialbalanceTab">
                        <div class="chart-container">
                            <canvas id="trialBalanceChart"></canvas>
                        </div>
                        <div class="table-container">
                            <table>
                                <thead>
                                    <tr>
                                        <th>Account Code</th>
                                        <th>Account Name</th>
                                        <th>Debit Balance</th>
                                        <th>Credit Balance</th>
                                        <th>Net Balance</th>
                                    </tr>
                                </thead>
                                <tbody id="trialBalanceTable"></tbody>
                            </table>
                        </div>
                    </div>

                    <div class="tab-content" id="ledgerTab">
                        <div class="search-filter">
                            <div class="search-box">
                                <i class="fas fa-search"></i>
                                <input type="text" class="form-control" id="ledgerSearch" placeholder="Search ledger entries...">
                            </div>
                            <select class="form-control filter-dropdown" id="ledgerAccountFilter">
                                <option value="">Select Account</option>
                            </select>
                            <input type="date" class="form-control filter-dropdown" id="ledgerDateFilter">
                        </div>
                        
                        <div class="table-container">
                            <table>
                                <thead>
                                    <tr>
                                        <th>Date</th>
                                        <th>Account</th>
                                        <th>Journal No.</th>
                                        <th>Debit</th>
                                        <th>Credit<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Enterprise Resource Planning</title>
    <link rel="stylesheet" href="style.css">
</head>

<body>

    <button class="toggle-sidebar" id="toggleSidebar">
        <i class="bars"></i>
    </button>

    <nav class="sidebar" id="sidebar">
        <div class="sidebar-header">
            <h2><i class="calculator"></i>ERP Finance</h2>
        </div>

        <ul class="sidebar-menu">
            <li><a href="" class="active" data-page="dashboard"><i class="home"></i> Dashboard</a></li>
            <li><a href="" data-page="coa"><i class="list"></i> Chart Of Accounts</a></li>
            <li><a href="" data-page="gl"><i class="book"></i> General Ledger</a></li>
            <li><a href="" data-page="ap"><i class="invoice-dollar"></i>Account Payable <span
                        class="badge new">5</span></a></li>
            <li><a href="" data-page="ar"><i class="hand-holding-usd"></i> Account Receivable <span
                        class="badge new">12</span></a></li>
            <li><a href="" data-page="assets"><i class="building"></i> Fixed Assets</a></li>
            <li><a href="" data-page="bank"><i class="university"></i> Bank & Receivable</a></li>
            <li><a href="" data-page="budget"><i class="chart-line"></i> Budgeting</a></li>
            <li><a href="" data-page="reports"><i class="chart-bar"></i> Financial Reports</a></li>
            <li><a href="" data-page="users"><i class="user-cog"></i> User Management</a></li>
            <li><a href="" data-page="setup"><i class="cogs"></i> Module Setup</a></li>
            <li><a href="" data-page="comparison"><i class="columns"></i> Domin Comparison</a></li>
        </ul>
    </nav>

    <main class="main-content" id="mainContent">

        <div class="topbar">
            <div class="page-title">
                <h1 id="pageTitle">Finance Dashboard</h1>
                <div class="subtitle" id="domainBadge">General Business</div>
            </div>
            <div class="user-actions">
                <div class="notification" onclick="toggleNotifications()">
                    <i class="bell" style="font-size: 1.3rem; color: #666;"> </i>
                    <span class="notification-badge">3</span>
                </div>
                <select class="form-control filter-dropdown" id="domainSelector" style="width: 180px;"
                    onchange="changeDomain(this.value)">
                    <option value="general">General Business</option>
                    <option value="hotel">Hotel Industry</option>
                    <option value="education">Education Sector</option>
                    <option value="banking">Banking</option>
                    <option value="manufacturing">Manufacturing</option>
                </select>
                <div class="user-profile" onclick="showUserMenu()">
                    <div class="user-avatar">
                        <span id="userInitials">AD</span>
                    </div>
                    <div class="user-info">
                        <h4 id="userName">Admin User</h4>
                        <p id="userRole">System Administrator</p>
                    </div>
                    <i class="chevron-down"></i>
                </div>
            </div>
        </div>

        <div class="content-area">
            <div class="page-content active" id="dashboardContent">
                <div class="card-container">
                    <div class="card">
                        <div class="card-header">
                            <div class="card-title"><i class="dollar-sign"></i>Total Revenue</div>
                            <i class="chart-line" style="color: var(--success);"></i>
                        </div>
                        <div class="card-value" id="totalRevenue">$ 245,830</div>
                        <div class="card-trend positive">
                            <i class="arrow-up"></i> 12.5% Vs last Month
                        </div>
                    </div>
                    <div class="card">
                        <div class="card-header">
                            <div class="card-title"><i class="file-invoice"></i> Account Receivable</div>
                            <i class="exclumation-circle" style="color: var(--warning);"></i>
                        </div>
                        <div class="card-value" id="totalAR">$ 42,560</div>
                        <div class="card-trend negative">
                            <i class="arrow-up"></i> 8.2% overdue
                        </div>
                    </div>
                    <div class="card">
                        <div class="card-header">
                            <div class="card-title"><i class="invoice-dollar"></i> Account Payable</div>
                            <i class="clock" style="color: var(--danger);"></i>
                        </div>
                        <div class="card-value" id="totalAP">$ 28, 750</div>
                        <div class="card-trend positive">
                            <i class="arrow-down"></i> 15.3% decrease
                        </div>
                    </div>
                    <div class="card">
                        <div class="card-header">
                            <div class="card-title"><i class="university"></i> Cash Balance</div>
                            <i class="piggy-bank" style="color: var(--primary);"></i>
                        </div>
                        <div class="card-value" id="cashBalance">$ 125,420</div>
                        <div class="card-trend positive">
                            <i class="arrow-up"></i> 5.8% increase
                        </div>
                    </div>
                </div>

                <div class="module-section">
                    <div class="section-header">
                        <h2 class="section-title"><i class="chart-line"></i> Financial Overview</h2>
                        <div class="section-action">
                            <select class="from-control" id="chartPeriod" style="width:  150px;"
                                onchange="updateFinancialChart()">
                                <option value="30">Last 30 Days</option>
                                <option value="90">LastQuarter</option>
                                <option value="365">Last Year</option>
                                <option value="ytd">Year TO Date</option>
                            </select>
                        </div>
                    </div>
                    <div class="chart-container">
                        <canvas id="financialChart"></canvas>
                    </div>
                </div>

                <div class="moule-selction">
                    <div class="section-header">
                        <h2 class="section-title"><i class="tasks"></i> Pending Actions</h2>
                        <button class="btn btn-primary" onclick="markAllComplete()">Mark All Complete</button>
                    </div>
                    <div class="table-container">
                        <table>
                            <thead>
                                <tr>
                                    <th>Action</th>
                                    <th>Module</th>
                                    <th>Priority</th>
                                    <th>Due Date</th>
                                    <th>Status</th>
                                    <th>Action</th>
                                </tr>
                            </thead>
                            <tbody id="pendingActions"></tbody>
                        </table>
                    </div>
                </div>
            </div>


            <div id="coContent" class="page-content" style="display: none;">
                <div class="module-section">
                    <div class="section-header">
                        <h2 class="section-title"><i class="list-alt"></i>Chart Of Accounts</h2>
                        <div class="section-actions">
                            <button class="btn btn-primary" onclick="showModal('addAccountModal')"><i
                                    class="plus"></i>Add Account</button>
                            <button class="btn btn-success" onclick="exportCOA()"><i class="export"></i>Export</button>
                            <button class="btn btn-info" onclick="loadSampleCOA()"><i class="download"></i>Load
                                Sample</button>
                        </div>
                    </div>

                    <div class="search-filter">
                        <div class="search-box">
                            <i class="search"></i>
                            <input type="text" class="form-control" id="coaSearch" placeholder="Search account..."
                                onkeyup="searchCOA()">
                        </div>
                        <select class="form-control filter-dropdown" id="coTypeFilter" onchange="filterCOA()">
                            <option value="all">All Types</option>
                            <option value="Asset">Asset</option>
                            <option value="Liability">Liability</option>
                            <option value="Equity">Equity</option>
                            <option value="Revenue">Revenue</option>
                            <option value="Expense">Expense</option>
                        </select>
                        <select class="form-control filter-dropdown" id="coStatusFilter" onchange="filterCOA()">
                            <option value="all">All Status</option>
                            <option value="Active">Active</option>
                            <option value="Inactive">Inactive</option>
                        </select>
                    </div>

                    <div class="tabs">
                        <div class="tab active" data-tab="accounts">Account List</div>
                        <div class="tab" data-tab="hierarchy">Account Hierarchy</div>
                        <div class="tab" data-tab="balance">Account Balances</div>
                    </div>

                    <div class="tab-content active" id="accountsTab">
                        <div class="table-container">
                            <table>
                                <thead>
                                    <tr>
                                        <th>Account Code</th>
                                        <th>Account Name</th>
                                        <th>Type</th>
                                        <th>Sub-type</th>
                                        <th>Balance</th>
                                        <th>Status</th>
                                    </tr>
                                </thead>
                                <tbody id="coTable"></tbody>
                            </table>
                        </div>
                    </div>

                    <div class="tab-content" id="hierarchyTab">
                        <div class="bank-card">
                            <h3>Account hierarchy</h3>
                            <div id="coHierarchy"></div>
                        </div>
                    </div>

                    <div class="tab-content" id="balancesTab">
                        <div class="chart-container">
                            <canvas id="coBalanceChart"></canvas>
                        </div>
                        <div class="table-container">
                            <table>
                                <thead>
                                    <tr>
                                        <th>Account Type</th>
                                        <th>Number Of Account</th>
                                        <th>Total Balance</th>
                                        <th>Percentage</th>
                                    </tr>
                                </thead>
                                <tbody id="coBalancesTable"></tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>

            <div id="ledgerContent" class="page-content" style="display: none;">
                <div class="module-section">
                    <div class="section-header">
                        <h2 class="section-title"><i class="book"></i> General Ledger</h2>
                        <div class="section-action">
                            <button class="btn btn-primary" onclick="showModal('journalEntryModal')"><i class="plus"></i> Add Journal Entry</button>
                            <button class="btn btn-success" onclick="postAllEntries()"><i class="check-circle"></i> Post All Entries</button>
                            <button class="btn btn-info" onclick="runMonthEndClose()"><i class="calender-check"></i> Month-end Close</button>
                        </div>
                    </div>

                    <div class="cards-container">
                        <div class="card">
                            <div class="card-header">
                                <div class="card-title">Total Journal Entries</div>
                                <i class="file-alt" style="color: var(--primary);"></i>
                            </div>
                            <div class="card-value"><span id="totalJournals">0</span></div>
                        </div>
                        <div class="card">
                            <div class="card-header">
                                <div class="card-title">Unposted Entries</div>
                                <i class="clock" style="color: var(--warning);"></i>
                            </div>
                            <div class="card-value"><span id="unpostJournals">0</span></div>
                        </div>
                        <div class="card">
                            <div class="card-header">
                                <div class="card-title">This Month</div>
                                <i class="calendar" style="color: var(--info);"></i>
                            </div>
                            <div class="card-value"><span id="monthJournals">0</span></div>
                        </div>
                        <div class="card">
                            <div class="card header">
                                <div class="card-title">Debit/Credit Balance</div>
                                <i class="balance-scale" style="color: var(--success);"></i>
                            </div>
                            <div class="card-value" style="font-size: 1.5rem;"><span id="debitCreditBalance">$0.00</span></div>
                        </div>
                    </div>

                    <div class="workflow-steps">
                        <div class="step completed" id="step1">
                            <i class="plus"></i>
                            <div class="step-label">Creat Entry</div>
                        </div>
                        <div class="step" id="step2">
                            <i class="eye"></i>
                            <div class="step-label">Review</div>
                        </div>
                        <div class="step" id="step3">
                            <i class="check"></i>
                            <div class="step-label">Approve</div>
                        </div>
                        <div class="step" id="step4">
                            <i class="book"></i>
                            <div class="step-label">Post To GL</div>
                        </div>
                    </div>

                    <div class="tabs">
                        <div class="tab active" data-tab="journals">Journal Entries</div>
                        <div class="tab" data-tab="trialbalance">Trial Balance</div>
                        <div class="tab" data-tab="ledger">Ledger Details</div>
                        <div class="tab" data-tab="closing">Period Closing</div>
                    </div>

                    <div class="tab-content active" id="journalsTab">
                        <div class="search-filter">
                            <div class="search-box">
                                <i class="search"></i>
                                <input type="text" class="form-control" id="journalSearch" placeholder="Search journal entries..." onkeyup="searchJournals()">
                            </div>
                            <select class="form-control filter-dropdown" id="journalStatusFilter" onchange="filterJournals()">
                                <option value="All">All Status</option>
                                <option value="Draft">Draft</option>
                                <option value="Pending">Pending</option>
                                <option value="Posted">Posted</option>
                            </select>
                            <input type="date" class="form-control filter-dropdown" id="journalDateFilter" onchange="filterJournals()">
                        </div>

                        <div class="table-container">
                            <table>
                                <thead>
                                    <tr>
                                        <th>Date</th>
                                        <th>Journal No.</th>
                                        <th>Description</th>
                                        <th>Debit Total</th>
                                        <th>Credit Total</th>
                                        <th>Status</th>
                                        <th>Action</th> 
                                    </tr>
                                </thead>
                                <tbody id="journalTable"></tbody>
                            </table>
                        </div>
                    </div>

                    <div class="tab-content" id="trialbalanceTab">
                        <div class="chart-container">
                            <canvas id="trialBalanceChart"></canvas>
                        </div>
                        <div class="table-container">
                            <table>
                               <thead>
                                 <tr>
                                    <th>Account Code</th>
                                    <th>Account Name</th>
                                    <th>Debit Balance</th>
                                    <th>Net Balance</th>
                                </tr>
                               </thead>
                               <tbody id="trialBalanceTable"></tbody>
                            </table>
                        </div>
                    </div>

                    <div class="tab-content" id="ledgerTab">
                        <div class="search-filter">
                            <div class="search-box">
                                <i class="search"></i>
                                <input type="text" class="form-control" id="ledgerSearch" placeholder="Search ledger entries..."> 
                            </div>
                            <select class="form-control filter-dropdown" id="ledgerAccountFilter">
                                <option value="">Select Account</option>
                            </select>
                            <input type="date" class="form-control filter-dropdown" id="ledgerDateFilter">
                        </div>

                        <div class="table-container">
                            <table>
                                <thead>
                                    <tr>
                                        <th>Date</th>
                                        <th>Account</th>
                                        <th>Journal No.</th>
                                        <th>Debit</th>
                                        <th>Credit</th>
                                        <th>Balance</th>
                                        <th>Description</th>
                                    </tr>
                                </thead>
                                <tbody id="ledgerTable"></tbody>
                            </table>
                        </div>
                    </div>

                    <div class="tab-content" id="closingTab">
                        <div class="bank-card">
                            <h3>Period Closing Process</h3>
                            <p>Run month-end or year-end closing procedures</p>

                            <div class="form-row">
                                <div class="form-group">
                                    <label class="form-label">Closing Period</label>
                                    <select class="form-control" id="closingPeriod">
                                        <option value="month">Month-end</option>
                                        <option value="quarter">Quarter-End</option>
                                        <option value="year">Year-End</option>
                                    </select>
                                </div>
                                <div class="form-group">
                                    <label class="form-label">Closing Date</label>
                                    <input type="date" class="form-control" id="closingDate">
                                </div>
                            </div>

                            <div class="form-group">
                                <label class="form-label">Closing Tasks</label>
                                <div id="closingTasks">
                                    <div class="form-check">
                                        <input type="checkbox" class="form-check-input" id="closeSublegers" checked>
                                        <label class="form-check-label" for="closeSubledgers">Close Sub-ledgers (AP/AR)</label>
                                    </div>
                                    <div class="form-check">
                                        <input type="checkbox" class="form-check-input" id="runDepreciation" checked>
                                        <label class="form-check-lable" for="runDepreciation">Run runDepreciation</label>
                                    </div>
                                    <div class="form-check">
                                        <input type="checkbox" class="form-check-input" id="postAccruals" checked>
                                        <label class="form-check-label" for="postAccruals">Post Accruals & Adjustments</label>
                                    </div>
                                    <div class="form-check">
                                        <input type="checkbox" class="form-check-input" id="reconcileAccounts" checked>
                                        <label class="form-check-label" for="reconcileAccounts">Reconcile Accounts</label>
                                    </div>
                                    <div class="form-check">
                                        <input type="checkbox" class="form-check-input" id="generateReports" checked>
                                        <label class="form-check-label" for="generateReports">Generate Financial Reports</label>
                                    </div>
                                </div>
                            </div>

                            <div style="text-align: center; margin-top: 30;">
                                <button class="btn btn-success" onclick="runClosingProcess()">Run Closing Process</button>
                                <button class="btn btn-outline" onclick="reverseClosing()">Reverse Last Closing</button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="page-content" id="Content" style="display: none;">
                <div class="module-section">
                    <div class="section-header">
                        <h2 class="section-title"><i class="file-invoice-dollar"></i>Account Payable</h2>
                        <div class="section-actions">
                            <button class="btn btn-primary" onclick="showModal('addInvoiceModal')"><i class="plus"></i>Add Invoice</button>
                            <button class="btn btn-success" onclick="processBatchPayments()"><i class="money-check-alt"></i>Process Payments</button>
                            <button class="btn btn-outline" onclick="exportAPData()"><i class="export"></i> Export</button>
                        </div>
                    </div>

                    <div class="search-filter">
                        <div class="search-box">
                            <i class="search"></i>
                            <input type="text" class="form-control" id="apSearch" placeholder="Search invoice, vendors..." onkeyup="searchAP()">
                        </div>
                        <select class="form-control filter-dropdown" id="apVendorFilter" onchange="filterAP()">
                            <option value="all">All vendors</option>
                        </select>
                    </div>

                    <div class="card-container">
                        <div class="card">
                            <div class="card-header">
                                <div class="card-title">Total Due</div>
                                <i class="exclamation-circle" style="color: var(--danger);"></i>
                            </div>
                            <div class="card-value">$ <span id="apTotalDue">28,750</span></div>
                        </div>
                        <div class="card">
                            <div class="card-header">
                                <div class="card-title">Overdue</div>
                                <i class="clock" style="color: var(--warning);"></i>
                            </div>
                            <div class="card-value">$ <span id="apOverdue">5,420</span></div>
                        </div>
                        <div class="card">
                            <div class="card-header">
                                <div class="card-title">Due This Week</div>
                                <i class="calender-week" style="color: var(--primary);"></i>
                            </div>
                            <div class="card-value">$ <span id="apDueThisWeek">12,350</span></div>
                        </div>
                        <div class="card">
                            <div class="card-header">
                                <div class="card-title">Vandor</div>
                                <i class="users" style="color: var(--success);"></i>
                            </div>
                            <div class="card-value"><span id="apVendorCount">42</span></div>
                        </div>
                    </div>

                    <div class="tabs">
                        <div class="tab active" data-tab="invoices">Invoices</div>
                        <div class="tab" data-tab="Vendors">Vendors</div>
                        <div class="tab" data-tab="payments">Payment History</div>
                        <div class="tab" data-tab="againg">Aging Analysis</div>
                    </div>

                    <div class="tab-content active" id="invoicesTab">
                        <div class="table-container">
                            <table>
                                <thead>
                                    <th>Vendor</th>
                                    <th>Invoice No.</th>
                                    <th>Due Date</th>
                                    <th>Amount</th>
                                    <th>Status</th>
                                    <th>Actions</th>
                                </thead>
                                <tbody id="apTable"></tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>

            <div class="page-content" id="arContent" style="display: none;">
                <div class="module-section">
                    <div class="section-header">
                        <h2 class="section-title"><i class="holding-usd"></i>Account Receivable</h2>
                        <div class="section-action">
                            <button class="btn-primary" onclick="ShowModal('addInvoiceARModal')"><i class="plus"></i>Create Invoice</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </main>
    <script src="script.js"></script>
</body>

</html>
</th>
                                        <th>Balance</th>
                                        <th>Description</th>
                                    </tr>
                                </thead>
                                <tbody id="ledgerTable"></tbody>
                            </table>
                        </div>
                    </div>

                    <div class="tab-content" id="closingTab">
                        <div class="bank-card">
                            <h3>Period Closing Process</h3>
                            <p>Run month-end or year-end closing procedures</p>
                            
                            <div class="form-row">
                                <div class="form-group">
                                    <label class="form-label">Closing Period</label>
                                    <select class="form-control" id="closingPeriod">
                                        <option value="month">Month-End</option>
                                        <option value="quarter">Quarter-End</option>
                                        <option value="year">Year-End</option>
                                    </select>
                                </div>
                                <div class="form-group">
                                    <label class="form-label">Closing Date</label>
                                    <input type="date" class="form-control" id="closingDate">
                                </div>
                            </div>
                            
                            <div class="form-group">
                                <label class="form-label">Closing Tasks</label>
                                <div id="closingTasks">
                                    <div class="form-check">
                                        <input type="checkbox" class="form-check-input" id="closeSubledgers" checked>
                                        <label class="form-check-label" for="closeSubledgers">Close Sub-ledgers (AP/AR)</label>
                                    </div>
                                    <div class="form-check">
                                        <input type="checkbox" class="form-check-input" id="runDepreciation" checked>
                                        <label class="form-check-label" for="runDepreciation">Run Depreciation</label>
                                    </div>
                                    <div class="form-check">
                                        <input type="checkbox" class="form-check-input" id="postAccruals" checked>
                                        <label class="form-check-label" for="postAccruals">Post Accruals & Adjustments</label>
                                    </div>
                                    <div class="form-check">
                                        <input type="checkbox" class="form-check-input" id="reconcileAccounts" checked>
                                        <label class="form-check-label" for="reconcileAccounts">Reconcile Accounts</label>
                                    </div>
                                    <div class="form-check">
                                        <input type="checkbox" class="form-check-input" id="generateReports" checked>
                                        <label class="form-check-label" for="generateReports">Generate Financial Reports</label>
                                    </div>
                                </div>
                            </div>
                            
                            <div style="text-align: center; margin-top: 30px;">
                                <button class="btn btn-success" onclick="runClosingProcess()">Run Closing Process</button>
                                <button class="btn btn-outline" onclick="reverseClosing()">Reverse Last Closing</button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Accounts Payable -->
            <div id="apContent" class="page-content" style="display: none;">
                <div class="module-section">
                    <div class="section-header">
                        <h2 class="section-title"><i class="fas fa-file-invoice-dollar"></i> Accounts Payable</h2>
                        <div class="section-actions">
                            <button class="btn btn-primary" onclick="showModal('addInvoiceModal')"><i class="fas fa-plus"></i> Add Invoice</button>
                            <button class="btn btn-success" onclick="processBatchPayments()"><i class="fas fa-money-check-alt"></i> Process Payments</button>
                            <button class="btn btn-outline" onclick="exportAPData()"><i class="fas fa-file-export"></i> Export</button>
                        </div>
                    </div>
                    
                    <div class="search-filter">
                        <div class="search-box">
                            <i class="fas fa-search"></i>
                            <input type="text" class="form-control" id="apSearch" placeholder="Search invoices, vendors..." onkeyup="searchAP()">
                        </div>
                        <select class="form-control filter-dropdown" id="apStatusFilter" onchange="filterAP()">
                            <option value="all">All Status</option>
                            <option value="pending">Pending</option>
                            <option value="overdue">Overdue</option>
                            <option value="paid">Paid</option>
                        </select>
                        <select class="form-control filter-dropdown" id="apVendorFilter" onchange="filterAP()">
                            <option value="all">All Vendors</option>
                        </select>
                    </div>
                    
                    <div class="cards-container">
                        <div class="card">
                            <div class="card-header">
                                <div class="card-title">Total Due</div>
                                <i class="fas fa-exclamation-circle" style="color: var(--danger);"></i>
                            </div>
                            <div class="card-value">$ <span id="apTotalDue">28,750</span></div>
                        </div>
                        <div class="card">
                            <div class="card-header">
                                <div class="card-title">Overdue</div>
                                <i class="fas fa-clock" style="color: var(--warning);"></i>
                            </div>
                            <div class="card-value">$ <span id="apOverdue">5,420</span></div>
                        </div>
                        <div class="card">
                            <div class="card-header">
                                <div class="card-title">Due This Week</div>
                                <i class="fas fa-calendar-week" style="color: var(--primary);"></i>
                            </div>
                            <div class="card-value">$ <span id="apDueThisWeek">12,350</span></div>
                        </div>
                        <div class="card">
                            <div class="card-header">
                                <div class="card-title">Vendors</div>
                                <i class="fas fa-users" style="color: var(--success);"></i>
                            </div>
                            <div class="card-value"><span id="apVendorCount">42</span></div>
                        </div>
                    </div>

                    <div class="tabs">
                        <div class="tab active" data-tab="invoices">Invoices</div>
                        <div class="tab" data-tab="vendors">Vendors</div>
                        <div class="tab" data-tab="payments">Payment History</div>
                        <div class="tab" data-tab="aging">Aging Analysis</div>
                    </div>

                    <div class="tab-content active" id="invoicesTab">
                        <div class="table-container">
                            <table>
                                <thead>
                                    <tr>
                                        <th>Vendor</th>
                                        <th>Invoice No.</th>
                                        <th>Date</th>
                                        <th>Due Date</th>
                                        <th>Amount</th>
                                        <th>Status</th>
                                        <th>Actions</th>
                                    </tr>
                                </thead>
                                <tbody id="apTable"></tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Accounts Receivable -->
            <div id="arContent" class="page-content" style="display: none;">
                <div class="module-section">
                    <div class="section-header">
                        <h2 class="section-title"><i class="fas fa-hand-holding-usd"></i> Accounts Receivable</h2>
                        <div class="section-actions">
                            <button class="btn btn-primary" onclick="showModal('addInvoiceARModal')"><i class="fas fa-plus"></i> Create Invoice</button>
                            <button class="btn btn-success" onclick="recordPayment()"><i class="fas fa-money-bill-wave"></i> Record Payment</button>
                            <button class="btn btn-warning" onclick="sendReminders()"><i class="fas fa-envelope"></i> Send Reminders</button>
                        </div>
                    </div>
                    
                    <div class="cards-container">
                        <div class="card">
                            <div class="card-header">
                                <div class="card-title">Total Receivables</div>
                                <i class="fas fa-file-invoice" style="color: var(--warning);"></i>
                            </div>
                            <div class="card-value">$ <span id="arTotal">42,560</span></div>
                        </div>
                        <div class="card">
                            <div class="card-header">
                                <div class="card-title">Overdue</div>
                                <i class="fas fa-exclamation-triangle" style="color: var(--danger);"></i>
                            </div>
                            <div class="card-value">$ <span id="arOverdue">8,250</span></div>
                        </div>
                        <div class="card">
                            <div class="card-header">
                                <div class="card-title">Due This Week</div>
                                <i class="fas fa-calendar-week" style="color: var(--primary);"></i>
                            </div>
                            <div class="card-value">$ <span id="arDueThisWeek">15,300</span></div>
                        </div>
                        <div class="card">
                            <div class="card-header">
                                <div class="card-title">Customers</div>
                                <i class="fas fa-user-friends" style="color: var(--success);"></i>
                            </div>
                            <div class="card-value"><span id="arCustomerCount">78</span></div>
                        </div>
                    </div>

                    <div class="tabs">
                        <div class="tab active" data-tab="arinvoices">Invoices</div>
                        <div class="tab" data-tab="arcustomers">Customers</div>
                        <div class="tab" data-tab="arcollections">Collections</div>
                        <div class="tab" data-tab="araging">Aging Analysis</div>
                    </div>

                    <div class="tab-content active" id="arinvoicesTab">
                        <div class="table-container">
                            <table>
                                <thead>
                                    <tr>
                                        <th>Customer</th>
                                        <th>Invoice No.</th>
                                        <th>Date</th>
                                        <th>Due Date</th>
                                        <th>Amount</th>
                                        <th>Balance</th>
                                        <th>Status</th>
                                        <th>Actions</th>
                                    </tr>
                                </thead>
                                <tbody id="arTable"></tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Fixed Assets -->
            <div id="assetsContent" class="page-content" style="display: none;">
                <div class="module-section">
                    <div class="section-header">
                        <h2 class="section-title"><i class="fas fa-building"></i> Fixed Assets</h2>
                        <div class="section-actions">
                            <button class="btn btn-primary" onclick="addFixedAsset()"><i class="fas fa-plus"></i> Add Asset</button>
                            <button class="btn btn-success" onclick="runDepreciation()"><i class="fas fa-calculator"></i> Run Depreciation</button>
                            <button class="btn btn-outline" onclick="exportAssets()"><i class="fas fa-file-export"></i> Export</button>
                        </div>
                    </div>
                    
                    <div class="cards-container">
                        <div class="card">
                            <div class="card-header">
                                <div class="card-title">Total Assets Value</div>
                                <i class="fas fa-building" style="color: var(--primary);"></i>
                            </div>
                            <div class="card-value">$ <span id="totalAssetsValue">250,000</span></div>
                        </div>
                        <div class="card">
                            <div class="card-header">
                                <div class="card-title">Accumulated Depreciation</div>
                                <i class="fas fa-chart-line" style="color: var(--warning);"></i>
                            </div>
                            <div class="card-value">$ <span id="totalDepreciation">45,250</span></div>
                        </div>
                        <div class="card">
                            <div class="card-header">
                                <div class="card-title">Net Book Value</div>
                                <i class="fas fa-balance-scale" style="color: var(--success);"></i>
                            </div>
                            <div class="card-value">$ <span id="netBookValue">204,750</span></div>
                        </div>
                        <div class="card">
                            <div class="card-header">
                                <div class="card-title">Active Assets</div>
                                <i class="fas fa-boxes" style="color: var(--info);"></i>
                            </div>
                            <div class="card-value"><span id="activeAssetsCount">24</span></div>
                        </div>
                    </div>

                    <div class="tabs">
                        <div class="tab active" data-tab="assetslist">Assets List</div>
                        <div class="tab" data-tab="depreciation">Depreciation Schedule</div>
                        <div class="tab" data-tab="disposals">Asset Disposals</div>
                    </div>

                    <div class="tab-content active" id="assetslistTab">
                        <div class="table-container">
                            <table>
                                <thead>
                                    <tr>
                                        <th>Asset ID</th>
                                        <th>Asset Name</th>
                                        <th>Category</th>
                                        <th>Purchase Date</th>
                                        <th>Purchase Value</th>
                                        <th>Current Value</th>
                                        <th>Status</th>
                                        <th>Actions</th>
                                    </tr>
                                </thead>
                                <tbody id="assetsTable"></tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Bank & Reconciliation -->
            <div id="bankContent" class="page-content" style="display: none;">
                <div class="module-section">
                    <div class="section-header">
                        <h2 class="section-title"><i class="fas fa-university"></i> Bank & Reconciliation</h2>
                        <div class="section-actions">
                            <button class="btn btn-primary" onclick="addBankAccount()"><i class="fas fa-plus"></i> Add Bank Account</button>
                            <button class="btn btn-success" onclick="importBankStatement()"><i class="fas fa-file-import"></i> Import Statement</button>
                            <button class="btn btn-info" onclick="reconcileAccount()"><i class="fas fa-sync-alt"></i> Reconcile</button>
                        </div>
                    </div>
                    
                    <div class="cards-container">
                        <div class="card">
                            <div class="card-header">
                                <div class="card-title">Total Bank Balance</div>
                                <i class="fas fa-university" style="color: var(--primary);"></i>
                            </div>
                            <div class="card-value">$ <span id="totalBankBalance">125,420</span></div>
                        </div>
                        <div class="card">
                            <div class="card-header">
                                <div class="card-title">Unreconciled Items</div>
                                <i class="fas fa-exclamation-triangle" style="color: var(--warning);"></i>
                            </div>
                            <div class="card-value"><span id="unreconciledCount">18</span></div>
                        </div>
                        <div class="card">
                            <div class="card-header">
                                <div class="card-title">Last Reconciliation</div>
                                <i class="fas fa-calendar-check" style="color: var(--success);"></i>
                            </div>
                            <div class="card-value" style="font-size: 1.2rem;"><span id="lastReconciliation">Oct 25, 2023</span></div>
                        </div>
                        <div class="card">
                            <div class="card-header">
                                <div class="card-title">Bank Accounts</div>
                                <i class="fas fa-credit-card" style="color: var(--info);"></i>
                            </div>
                            <div class="card-value"><span id="bankAccountsCount">4</span></div>
                        </div>
                    </div>

                    <div class="tabs">
                        <div class="tab active" data-tab="bankaccounts">Bank Accounts</div>
                        <div class="tab" data-tab="transactions">Bank Transactions</div>
                        <div class="tab" data-tab="reconciliation">Reconciliation</div>
                    </div>

                    <div class="tab-content active" id="bankaccountsTab">
                        <div class="table-container">
                            <table>
                                <thead>
                                    <tr>
                                        <th>Account Name</th>
                                        <th>Bank Name</th>
                                        <th>Account Number</th>
                                        <th>Account Type</th>
                                        <th>Current Balance</th>
                                        <th>Last Updated</th>
                                        <th>Status</th>
                                        <th>Actions</th>
                                    </tr>
                                </thead>
                                <tbody id="bankAccountsTable"></tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Budgeting -->
            <div id="budgetContent" class="page-content" style="display: none;">
                <div class="module-section">
                    <div class="section-header">
                        <h2 class="section-title"><i class="fas fa-chart-line"></i> Budgeting</h2>
                        <div class="section-actions">
                            <button class="btn btn-primary" onclick="createBudget()"><i class="fas fa-plus"></i> Create Budget</button>
                            <button class="btn btn-success" onclick="copyBudget()"><i class="fas fa-copy"></i> Copy from Previous</button>
                            <button class="btn btn-info" onclick="analyzeVariance()"><i class="fas fa-chart-bar"></i> Variance Analysis</button>
                        </div>
                    </div>
                    
                    <div class="cards-container">
                        <div class="card">
                            <div class="card-header">
                                <div class="card-title">Current Budget</div>
                                <i class="fas fa-calendar-alt" style="color: var(--primary);"></i>
                            </div>
                            <div class="card-value">Q4 2023</div>
                        </div>
                        <div class="card">
                            <div class="card-header">
                                <div class="card-title">Total Budget</div>
                                <i class="fas fa-dollar-sign" style="color: var(--success);"></i>
                            </div>
                            <div class="card-value">$ <span id="totalBudget">450,000</span></div>
                        </div>
                        <div class="card">
                            <div class="card-header">
                                <div class="card-title">Actual vs Budget</div>
                                <i class="fas fa-chart-pie" style="color: var(--warning);"></i>
                            </div>
                            <div class="card-value"><span id="budgetVariance">95.2%</span></div>
                        </div>
                        <div class="card">
                            <div class="card-header">
                                <div class="card-title">Over Budget Items</div>
                                <i class="fas fa-exclamation-circle" style="color: var(--danger);"></i>
                            </div>
                            <div class="card-value"><span id="overBudgetCount">3</span></div>
                        </div>
                    </div>

                    <div class="chart-container">
                        <canvas id="budgetChart"></canvas>
                    </div>

                    <div class="tabs">
                        <div class="tab active" data-tab="budgetplan">Budget Plan</div>
                        <div class="tab" data-tab="budgetvsactual">Budget vs Actual</div>
                        <div class="tab" data-tab="variancedetails">Variance Details</div>
                    </div>

                    <div class="tab-content active" id="budgetplanTab">
                        <div class="table-container">
                            <table>
                                <thead>
                                    <tr>
                                        <th>Account</th>
                                        <th>Budget Amount</th>
                                        <th>Actual Amount</th>
                                        <th>Variance</th>
                                        <th>% Used</th>
                                        <th>Status</th>
                                    </tr>
                                </thead>
                                <tbody id="budgetTable"></tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Financial Reports -->
            <div id="reportsContent" class="page-content" style="display: none;">
                <div class="module-section">
                    <div class="section-header">
                        <h2 class="section-title"><i class="fas fa-chart-bar"></i> Financial Reports</h2>
                        <div class="section-actions">
                            <button class="btn btn-primary" onclick="generateFinancialStatement('balancesheet')"><i class="fas fa-file-invoice-dollar"></i> Balance Sheet</button>
                            <button class="btn btn-success" onclick="generateFinancialStatement('incomestatement')"><i class="fas fa-chart-line"></i> Income Statement</button>
                            <button class="btn btn-info" onclick="generateFinancialStatement('cashflow')"><i class="fas fa-money-bill-wave"></i> Cash Flow</button>
                        </div>
                    </div>
                    
                    <div class="cards-container">
                        <div class="card report-card">
                            <div class="card-header">
                                <div class="card-title"><i class="fas fa-balance-scale"></i> Balance Sheet</div>
                                <i class="fas fa-download" style="color: var(--primary); cursor: pointer;" onclick="downloadReport('balancesheet')"></i>
                            </div>
                            <p>Snapshot of financial position at a specific date</p>
                            <div class="card-trend">
                                <i class="fas fa-calendar"></i> As of Oct 31, 2023
                            </div>
                            <button class="btn btn-outline" onclick="viewReport('balancesheet')" style="margin-top: 15px;">View Report</button>
                        </div>
                        
                        <div class="card report-card">
                            <div class="card-header">
                                <div class="card-title"><i class="fas fa-chart-line"></i> Income Statement</div>
                                <i class="fas fa-download" style="color: var(--success); cursor: pointer;" onclick="downloadReport('incomestatement')"></i>
                            </div>
                            <p>Profit and loss for the period</p>
                            <div class="card-trend">
                                <i class="fas fa-calendar"></i> Q3 2023
                            </div>
                            <button class="btn btn-outline" onclick="viewReport('incomestatement')" style="margin-top: 15px;">View Report</button>
                        </div>
                        
                        <div class="card report-card">
                            <div class="card-header">
                                <div class="card-title"><i class="fas fa-money-bill-wave"></i> Cash Flow</div>
                                <i class="fas fa-download" style="color: var(--info); cursor: pointer;" onclick="downloadReport('cashflow')"></i>
                            </div>
                            <p>Cash inflows and outflows</p>
                            <div class="card-trend">
                                <i class="fas fa-calendar"></i> Year to Date
                            </div>
                            <button class="btn btn-outline" onclick="viewReport('cashflow')" style="margin-top: 15px;">View Report</button>
                        </div>
                        
                        <div class="card report-card">
                            <div class="card-header">
                                <div class="card-title"><i class="fas fa-chart-pie"></i> Financial Ratios</div>
                                <i class="fas fa-download" style="color: var(--warning); cursor: pointer;" onclick="downloadReport('ratios')"></i>
                            </div>
                            <p>Key performance indicators</p>
                            <div class="card-trend">
                                <i class="fas fa-chart-bar"></i> 12 ratios calculated
                            </div>
                            <button class="btn btn-outline" onclick="viewReport('ratios')" style="margin-top: 15px;">View Report</button>
                        </div>
                    </div>

                    <div class="tabs">
                        <div class="tab active" data-tab="balancesheet">Balance Sheet</div>
                        <div class="tab" data-tab="incomestatement">Income Statement</div>
                        <div class="tab" data-tab="cashflow">Cash Flow</div>
                        <div class="tab" data-tab="ratios">Financial Ratios</div>
                    </div>

                    <div class="tab-content active" id="balancesheetTab">
                        <div class="table-container">
                            <table>
                                <thead>
                                    <tr>
                                        <th colspan="2" style="text-align: center; background: var(--primary); color: white;">BALANCE SHEET</th>
                                    </tr>
                                    <tr>
                                        <th colspan="2" style="text-align: center;">As of October 31, 2023</th>
                                    </tr>
                                </thead>
                                <tbody id="balanceSheetTable"></tbody>
                            </table>
                        </div>
                    </div>
                    
                    <div class="tab-content" id="incomestatementTab">
                        <div class="table-container">
                            <table>
                                <thead>
                                    <tr>
                                        <th colspan="2" style="text-align: center; background: var(--success); color: white;">INCOME STATEMENT</th>
                                    </tr>
                                    <tr>
                                        <th colspan="2" style="text-align: center;">For the Quarter Ended October 31, 2023</th>
                                    </tr>
                                </thead>
                                <tbody id="incomeStatementTable"></tbody>
                            </table>
                        </div>
                    </div>
                    
                    <div class="tab-content" id="cashflowTab">
                        <div class="table-container">
                            <table>
                                <thead>
                                    <tr>
                                        <th colspan="2" style="text-align: center; background: var(--info); color: white;">STATEMENT OF CASH FLOWS</th>
                                    </tr>
                                    <tr>
                                        <th colspan="2" style="text-align: center;">For the Quarter Ended October 31, 2023</th>
                                    </tr>
                                </thead>
                                <tbody id="cashFlowTable"></tbody>
                            </table>
                        </div>
                    </div>
                    
                    <div class="tab-content" id="ratiosTab">
                        <div class="table-container">
                            <table>
                                <thead>
                                    <tr>
                                        <th colspan="3" style="text-align: center; background: var(--warning); color: white;">FINANCIAL RATIOS ANALYSIS</th>
                                    </tr>
                                    <tr>
                                        <th colspan="3" style="text-align: center;">As of October 31, 2023</th>
                                    </tr>
                                    <tr>
                                        <th>Ratio</th>
                                        <th>Value</th>
                                        <th>Industry Benchmark</th>
                                    </tr>
                                </thead>
                                <tbody id="ratiosTable"></tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>

            <!-- User Management -->
            <div id="usersContent" class="page-content" style="display: none;">
                <div class="module-section">
                    <div class="section-header">
                        <h2 class="section-title"><i class="fas fa-users-cog"></i> User Management</h2>
                        <div class="section-actions">
                            <button class="btn btn-primary" onclick="addUser()"><i class="fas fa-plus"></i> Add User</button>
                            <button class="btn btn-success" onclick="manageRoles()"><i class="fas fa-user-shield"></i> Manage Roles</button>
                            <button class="btn btn-info" onclick="auditLogs()"><i class="fas fa-history"></i> View Audit Logs</button>
                        </div>
                    </div>
                    
                    <div class="cards-container">
                        <div class="card">
                            <div class="card-header">
                                <div class="card-title">Total Users</div>
                                <i class="fas fa-users" style="color: var(--primary);"></i>
                            </div>
                            <div class="card-value"><span id="totalUsers">8</span></div>
                        </div>
                        <div class="card">
                            <div class="card-header">
                                <div class="card-title">Active Users</div>
                                <i class="fas fa-user-check" style="color: var(--success);"></i>
                            </div>
                            <div class="card-value"><span id="activeUsers">7</span></div>
                        </div>
                        <div class="card">
                            <div class="card-header">
                                <div class="card-title">Inactive Users</div>
                                <i class="fas fa-user-slash" style="color: var(--danger);"></i>
                            </div>
                            <div class="card-value"><span id="inactiveUsers">1</span></div>
                        </div>
                        <div class="card">
                            <div class="card-header">
                                <div class="card-title">User Roles</div>
                                <i class="fas fa-user-tag" style="color: var(--info);"></i>
                            </div>
                            <div class="card-value"><span id="userRolesCount">4</span></div>
                        </div>
                    </div>

                    <div class="tabs">
                        <div class="tab active" data-tab="userslist">Users List</div>
                        <div class="tab" data-tab="roles">Roles & Permissions</div>
                        <div class="tab" data-tab="audit">Audit Trail</div>
                    </div>

                    <div class="tab-content active" id="userslistTab">
                        <div class="table-container">
                            <table>
                                <thead>
                                    <tr>
                                        <th>User ID</th>
                                        <th>Full Name</th>
                                        <th>Email</th>
                                        <th>Role</th>
                                        <th>Department</th>
                                        <th>Last Login</th>
                                        <th>Status</th>
                                        <th>Actions</th>
                                    </tr>
                                </thead>
                                <tbody id="usersTable"></tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Module Setup -->
            <div id="setupContent" class="page-content" style="display: none;">
                <div class="module-section">
                    <div class="section-header">
                        <h2 class="section-title"><i class="fas fa-cogs"></i> Module Setup</h2>
                        <div class="section-actions">
                            <button class="btn btn-primary" onclick="saveSetup()"><i class="fas fa-save"></i> Save Settings</button>
                            <button class="btn btn-success" onclick="testConnection()"><i class="fas fa-plug"></i> Test Connection</button>
                            <button class="btn btn-info" onclick="backupConfig()"><i class="fas fa-database"></i> Backup Config</button>
                        </div>
                    </div>
                    
                    <div class="workflow-steps">
                        <div class="step completed">
                            <i class="fas fa-list-alt"></i>
                            <div class="step-label">Chart of Accounts</div>
                        </div>
                        <div class="step completed">
                            <i class="fas fa-cog"></i>
                            <div class="step-label">Financial Structure</div>
                        </div>
                        <div class="step active">
                            <i class="fas fa-users"></i>
                            <div class="step-label">Business Partners</div>
                        </div>
                        <div class="step">
                            <i class="fas fa-exchange-alt"></i>
                            <div class="step-label">Transaction Setup</div>
                        </div>
                        <div class="step">
                            <i class="fas fa-chart-bar"></i>
                            <div class="step-label">Reporting</div>
                        </div>
                        <div class="step">
                            <i class="fas fa-user-shield"></i>
                            <div class="step-label">Users & Permissions</div>
                        </div>
                    </div>

                    <div class="tabs">
                        <div class="tab active" data-tab="generalsetup">General Setup</div>
                        <div class="tab" data-tab="companysetup">Company Information</div>
                        <div class="tab" data-tab="financialsetup">Financial Setup</div>
                        <div class="tab" data-tab="integrations">Integrations</div>
                    </div>

                    <div class="tab-content active" id="generalsetupTab">
                        <div class="form-row">
                            <div class="form-group">
                                <label class="form-label">Fiscal Year Start</label>
                                <select class="form-control" id="fiscalYearStart">
                                    <option value="01">January</option>
                                    <option value="04">April</option>
                                    <option value="07">July</option>
                                    <option value="10">October</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label class="form-label">Base Currency</label>
                                <select class="form-control" id="baseCurrency">
                                    <option value="USD">USD - US Dollar</option>
                                    <option value="EUR">EUR - Euro</option>
                                    <option value="GBP">GBP - British Pound</option>
                                    <option value="JPY">JPY - Japanese Yen</option>
                                </select>
                            </div>
                        </div>
                        
                        <div class="form-group">
                            <label class="form-label">Tax Identification Number</label>
                            <input type="text" class="form-control" id="taxId" placeholder="Enter TAX ID">
                        </div>
                        
                        <div class="form-group">
                            <label class="form-label">Accounting Method</label>
                            <select class="form-control" id="accountingMethod">
                                <option value="accrual">Accrual Basis</option>
                                <option value="cash">Cash Basis</option>
                            </select>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Domain Comparison -->
            <div id="comparisonContent" class="page-content" style="display: none;">
                <div class="module-section">
                    <div class="section-header">
                        <h2 class="section-title"><i class="fas fa-columns"></i> Domain Comparison</h2>
                        <div class="section-actions">
                            <button class="btn btn-primary" onclick="showDomainDetails('hotel')">Hotel</button>
                            <button class="btn btn-primary" onclick="showDomainDetails('education')">Education</button>
                            <button class="btn btn-primary" onclick="showDomainDetails('banking')">Banking</button>
                            <button class="btn btn-primary" onclick="showDomainDetails('manufacturing')">Manufacturing</button>
                        </div>
                    </div>
                    
                    <div class="domain-comparison">
                        <div class="domain-card domain-hotel">
                            <h3><i class="fas fa-hotel"></i> Hotel Industry</h3>
                            <p><strong>Revenue Recognition:</strong> Daily room revenue, event bookings</p>
                            <p><strong>Key Accounts:</strong> Rooms, F&B, Banquets</p>
                            <p><strong>AP Focus:</strong> Many small vendors (suppliers, services)</p>
                            <button class="btn btn-outline" style="margin-top: 10px;" onclick="applyDomainSettings('hotel')">Apply Settings</button>
                        </div>
                        
                        <div class="domain-card domain-education">
                            <h3><i class="fas fa-graduation-cap"></i> Education Sector</h3>
                            <p><strong>Revenue Recognition:</strong> Tuition fees, grants, research funds</p>
                            <p><strong>Key Accounts:</strong> Fund accounting, grants, research</p>
                            <p><strong>AP Focus:</strong> Faculty payments, infrastructure</p>
                            <button class="btn btn-outline" style="margin-top: 10px;" onclick="applyDomainSettings('education')">Apply Settings</button>
                        </div>
                        
                        <div class="domain-card domain-banking">
                            <h3><i class="fas fa-university"></i> Banking</h3>
                            <p><strong>Revenue Recognition:</strong> Interest income, fees, commissions</p>
                            <p><strong>Key Accounts:</strong> Regulatory structure, provisions</p>
                            <p><strong>AP Focus:</strong> Few large vendors, interbank</p>
                            <button class="btn btn-outline" style="margin-top: 10px;" onclick="applyDomainSettings('banking')">Apply Settings</button>
                        </div>
                        
                        <div class="domain-card domain-manufacturing">
                            <h3><i class="fas fa-industry"></i> Manufacturing</h3>
                            <p><strong>Revenue Recognition:</strong> Product sales, service contracts</p>
                            <p><strong>Key Accounts:</strong> Cost centers by product line</p>
                            <p><strong>AP Focus:</strong> Raw material suppliers, MRO</p>
                            <button class="btn btn-outline" style="margin-top: 10px;" onclick="applyDomainSettings('manufacturing')">Apply Settings</button>
                        </div>
                    </div>
                    
                    <div id="domainDetails" style="margin-top: 30px; display: none;">
                        <h3 id="domainDetailsTitle"></h3>
                        <div id="domainDetailsContent"></div>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <!-- Chart of Accounts Modal -->
    <div class="modal" id="addAccountModal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Add Account to Chart of Accounts</h3>
                <button class="close-btn" onclick="closeModal('addAccountModal')">&times;</button>
            </div>
            <div class="modal-body">
                <form id="addAccountForm">
                    <div class="form-row">
                        <div class="form-group">
                            <label class="form-label">Account Code *</label>
                            <input type="text" class="form-control" id="accountCode" required>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Parent Account</label>
                            <select class="form-control" id="parentAccount">
                                <option value="">No Parent (Top Level)</option>
                            </select>
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label">Account Name *</label>
                        <input type="text" class="form-control" id="accountName" required>
                    </div>
                    
                    <div class="form-row">
                        <div class="form-group">
                            <label class="form-label">Account Type *</label>
                            <select class="form-control" id="accountType" required>
                                <option value="">Select Type</option>
                                <option value="Asset">Asset</option>
                                <option value="Liability">Liability</option>
                                <option value="Equity">Equity</option>
                                <option value="Revenue">Revenue</option>
                                <option value="Expense">Expense</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Sub-Type</label>
                            <select class="form-control" id="accountSubType">
                                <option value="">Select Sub-Type</option>
                                <option value="Current Asset">Current Asset</option>
                                <option value="Fixed Asset">Fixed Asset</option>
                                <option value="Current Liability">Current Liability</option>
                                <option value="Long-term Liability">Long-term Liability</option>
                                <option value="Operating Revenue">Operating Revenue</option>
                                <option value="Non-operating Revenue">Non-operating Revenue</option>
                            </select>
                        </div>
                    </div>
                    
                    <div class="form-row">
                        <div class="form-group">
                            <label class="form-label">Opening Balance</label>
                            <input type="number" class="form-control" id="accountBalance" step="0.01" value="0">
                        </div>
                        <div class="form-group">
                            <label class="form-label">Currency</label>
                            <select class="form-control" id="accountCurrency">
                                <option value="USD">USD</option>
                                <option value="EUR">EUR</option>
                                <option value="GBP">GBP</option>
                            </select>
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label">Description</label>
                        <textarea class="form-control" id="accountDescription" rows="3"></textarea>
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label">
                            <input type="checkbox" id="accountActive" checked> Active Account
                        </label>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button class="btn btn-outline" onclick="closeModal('addAccountModal')">Cancel</button>
                <button class="btn btn-primary" onclick="saveAccount()">Save Account</button>
            </div>
        </div>
    </div>

    <!-- Journal Entry Modal -->
    <div class="modal" id="journalEntryModal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Create Journal Entry</h3>
                <button class="close-btn" onclick="closeModal('journalEntryModal')">&times;</button>
            </div>
            <div class="modal-body">
                <form id="journalEntryForm">
                    <div class="form-row">
                        <div class="form-group">
                            <label class="form-label">Entry Date *</label>
                            <input type="date" class="form-control" id="journalDate" required value="2023-10-31">
                        </div>
                        <div class="form-group">
                            <label class="form-label">Journal Type</label>
                            <select class="form-control" id="journalType">
                                <option value="General">General Journal</option>
                                <option value="Sales">Sales Journal</option>
                                <option value="Purchase">Purchase Journal</option>
                                <option value="Cash">Cash Journal</option>
                            </select>
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label">Description *</label>
                        <input type="text" class="form-control" id="journalDescription" required placeholder="Enter journal entry description">
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label">Reference Number</label>
                        <input type="text" class="form-control" id="journalReference" placeholder="Optional reference">
                    </div>
                    
                    <h4>Journal Lines</h4>
                    <div id="journalLines">
                        <div class="journal-line" style="display: flex; gap: 10px; margin-bottom: 15px; align-items: center;">
                            <select class="form-control" style="flex: 2;" onchange="updateAccountBalance(this)">
                                <option value="">Select Account</option>
                            </select>
                            <input type="number" class="form-control" placeholder="Debit" style="flex: 1;" onchange="updateDebitCredit()" step="0.01">
                            <input type="number" class="form-control" placeholder="Credit" style="flex: 1;" onchange="updateDebitCredit()" step="0.01">
                            <input type="text" class="form-control" placeholder="Line Description" style="flex: 2;">
                            <button type="button" class="btn btn-danger btn-sm" onclick="removeJournalLine(this)"><i class="fas fa-times"></i></button>
                        </div>
                    </div>
                    
                    <button type="button" class="btn btn-outline" onclick="addJournalLine()"><i class="fas fa-plus"></i> Add Line</button>
                    
                    <div style="margin-top: 25px; padding: 20px; background: #f8f9fa; border-radius: 8px;">
                        <div class="form-row">
                            <div class="form-group">
                                <label class="form-label">Total Debit</label>
                                <input type="text" class="form-control" id="totalDebit" value="0.00" readonly style="font-weight: bold; color: var(--success);">
                            </div>
                            <div class="form-group">
                                <label class="form-label">Total Credit</label>
                                <input type="text" class="form-control" id="totalCredit" value="0.00" readonly style="font-weight: bold; color: var(--success);">
                            </div>
                            <div class="form-group">
                                <label class="form-label">Difference</label>
                                <input type="text" class="form-control" id="debitCreditDiff" value="0.00" readonly style="font-weight: bold; color: var(--danger);">
                            </div>
                        </div>
                        <div id="balanceStatus" style="text-align: center; padding: 10px; display: none;"></div>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button class="btn btn-outline" onclick="closeModal('journalEntryModal')">Cancel</button>
                <button class="btn btn-primary" onclick="saveJournalEntry()">Save Journal Entry</button>
            </div>
        </div>
    </div>

    <!-- Add Invoice Modal -->
    <div class="modal" id="addInvoiceModal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Add Invoice</h3>
                <button class="close-btn" onclick="closeModal('addInvoiceModal')">&times;</button>
            </div>
            <div class="modal-body">
                <form id="addInvoiceForm">
                    <div class="form-row">
                        <div class="form-group">
                            <label class="form-label">Vendor *</label>
                            <select class="form-control" id="invoiceVendor" required>
                                <option value="">Select Vendor</option>
                                <option value="Office Supplies Ltd">Office Supplies Ltd</option>
                                <option value="Tech Solutions Inc">Tech Solutions Inc</option>
                                <option value="Utilities Corp">Utilities Corp</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Invoice Number *</label>
                            <input type="text" class="form-control" id="invoiceNumber" required>
                        </div>
                    </div>
                    
                    <div class="form-row">
                        <div class="form-group">
                            <label class="form-label">Invoice Date *</label>
                            <input type="date" class="form-control" id="invoiceDate" required>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Due Date *</label>
                            <input type="date" class="form-control" id="invoiceDueDate" required>
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label">Amount *</label>
                        <input type="number" class="form-control" id="invoiceAmount" step="0.01" required>
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label">Description</label>
                        <textarea class="form-control" id="invoiceDescription" rows="3"></textarea>
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label">Account</label>
                        <select class="form-control" id="invoiceAccount">
                            <option value="">Select Account</option>
                            <option value="Accounts Payable">Accounts Payable</option>
                            <option value="Office Supplies Expense">Office Supplies Expense</option>
                            <option value="Utilities Expense">Utilities Expense</option>
                        </select>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button class="btn btn-outline" onclick="closeModal('addInvoiceModal')">Cancel</button>
                <button class="btn btn-primary" onclick="saveInvoice()">Save Invoice</button>
            </div>
        </div>
    </div>

    <!-- User Menu Dropdown -->
    <div id="userMenu" style="display: none; position: fixed; top: 70px; right: 30px; background: white; border-radius: 10px; box-shadow: 0 5px 25px rgba(0,0,0,0.1); z-index: 1000; min-width: 200px;">
        <div style="padding: 20px; border-bottom: 1px solid #eee;">
            <div style="font-weight: 600; color: #333;">Admin User</div>
            <div style="font-size: 0.9rem; color: #666;">admin@company.com</div>
        </div>
        <div style="padding: 10px 0;">
            <a href="#" style="display: block; padding: 12px 20px; color: #333; text-decoration: none; transition: background 0.3s;" onmouseover="this.style.background='#f5f5f5'">
                <i class="fas fa-user" style="width: 20px; margin-right: 10px;"></i> My Profile
            </a>
            <a href="#" style="display: block; padding: 12px 20px; color: #333; text-decoration: none; transition: background 0.3s;" onmouseover="this.style.background='#f5f5f5'">
                <i class="fas fa-cog" style="width: 20px; margin-right: 10px;"></i> Settings
            </a>
            <a href="#" style="display: block; padding: 12px 20px; color: #333; text-decoration: none; transition: background 0.3s;" onmouseover="this.style.background='#f5f5f5'">
                <i class="fas fa-lock" style="width: 20px; margin-right: 10px;"></i> Change Password
            </a>
            <div style="border-top: 1px solid #eee; margin-top: 10px;"></div>
            <a href="#" style="display: block; padding: 12px 20px; color: #d32f2f; text-decoration: none; transition: background 0.3s;" onmouseover="this.style.background='#ffebee'">
                <i class="fas fa-sign-out-alt" style="width: 20px; margin-right: 10px;"></i> Logout
            </a>
        </div>
    </div>

    <!-- Notifications Panel -->
    <div id="notificationsPanel" style="display: none; position: fixed; top: 70px; right: 30px; background: white; border-radius: 10px; box-shadow: 0 5px 25px rgba(0,0,0,0.1); z-index: 1000; width: 350px; max-height: 400px; overflow-y: auto;">
        <div style="padding: 20px; border-bottom: 1px solid #eee;">
            <h3 style="color: var(--primary);">Notifications</h3>
        </div>
        <div id="notificationsList" style="padding: 15px;">
            <!-- Notifications will be dynamically added here -->
        </div>
        <div style="padding: 15px; border-top: 1px solid #eee; text-align: center;">
            <button class="btn btn-outline" onclick="clearAllNotifications()">Clear All</button>
        </div>
    </div>

    <script>
        // Global State Management
        class ERPFinanceSystem {
            constructor() {
                this.state = {
                    currentDomain: 'general',
                    currentUser: {
                        id: 1,
                        name: 'Admin User',
                        role: 'admin',
                        email: 'admin@company.com',
                        department: 'Finance'
                    },
                    chartOfAccounts: [],
                    journalEntries: [],
                    vendors: [],
                    customers: [],
                    invoices: [],
                    bankAccounts: [],
                    fixedAssets: [],
                    budgets: [],
                    users: [],
                    notifications: [],
                    financialData: {
                        revenue: 245830,
                        accountsReceivable: 42560,
                        accountsPayable: 28750,
                        cashBalance: 125420
                    }
                };
                
                this.init();
            }
            
            init() {
                this.loadFromLocalStorage();
                this.setupEventListeners();
                this.renderDashboard();
                this.showPage('dashboard');
            }
            
            loadFromLocalStorage() {
                const saved = localStorage.getItem('erpFinanceData');
                if (saved) {
                    this.state = JSON.parse(saved);
                } else {
                    this.loadSampleData();
                }
            }
            
            saveToLocalStorage() {
                localStorage.setItem('erpFinanceData', JSON.stringify(this.state));
            }
            
            loadSampleData() {
                // Chart of Accounts
                this.state.chartOfAccounts = [
                    { id: 1, code: '1000', name: 'Cash', type: 'Asset', subType: 'Current Asset', balance: 125420, currency: 'USD', status: 'Active' },
                    { id: 2, code: '1100', name: 'Accounts Receivable', type: 'Asset', subType: 'Current Asset', balance: 42560, currency: 'USD', status: 'Active' },
                    { id: 3, code: '1200', name: 'Inventory', type: 'Asset', subType: 'Current Asset', balance: 85000, currency: 'USD', status: 'Active' },
                    { id: 4, code: '1500', name: 'Equipment', type: 'Asset', subType: 'Fixed Asset', balance: 250000, currency: 'USD', status: 'Active' },
                    { id: 5, code: '2000', name: 'Accounts Payable', type: 'Liability', subType: 'Current Liability', balance: 28750, currency: 'USD', status: 'Active' },
                    { id: 6, code: '2500', name: 'Loans Payable', type: 'Liability', subType: 'Long-term Liability', balance: 150000, currency: 'USD', status: 'Active' },
                    { id: 7, code: '3000', name: 'Common Stock', type: 'Equity', subType: '', balance: 200000, currency: 'USD', status: 'Active' },
                    { id: 8, code: '3100', name: 'Retained Earnings', type: 'Equity', subType: '', balance: 125230, currency: 'USD', status: 'Active' },
                    { id: 9, code: '4000', name: 'Sales Revenue', type: 'Revenue', subType: 'Operating Revenue', balance: 450000, currency: 'USD', status: 'Active' },
                    { id: 10, code: '4100', name: 'Service Revenue', type: 'Revenue', subType: 'Operating Revenue', balance: 85000, currency: 'USD', status: 'Active' },
                    { id: 11, code: '5000', name: 'Cost of Goods Sold', type: 'Expense', subType: '', balance: 225000, currency: 'USD', status: 'Active' },
                    { id: 12, code: '6000', name: 'Salaries Expense', type: 'Expense', subType: '', balance: 125000, currency: 'USD', status: 'Active' },
                    { id: 13, code: '6100', name: 'Rent Expense', type: 'Expense', subType: '', balance: 36000, currency: 'USD', status: 'Active' },
                    { id: 14, code: '6200', name: 'Utilities Expense', type: 'Expense', subType: '', balance: 8500, currency: 'USD', status: 'Active' }
                ];
                
                // Journal Entries
                this.state.journalEntries = [
                    { 
                        id: 1, 
                        date: '2023-10-05', 
                        journalNo: 'JRNL-001', 
                        description: 'Initial capital investment',
                        type: 'General',
                        reference: 'INV-001',
                        lines: [
                            { account: 'Cash', debit: 5000, credit: 0, description: 'Cash received' },
                            { account: 'Common Stock', debit: 0, credit: 5000, description: 'Capital investment' }
                        ],
                        status: 'Posted',
                        totalDebit: 5000,
                        totalCredit: 5000
                    },
                    { 
                        id: 2, 
                        date: '2023-10-06', 
                        journalNo: 'JRNL-002', 
                        description: 'Purchase of computer equipment',
                        type: 'Purchase',
                        reference: 'PO-001',
                        lines: [
                            { account: 'Equipment', debit: 2500, credit: 0, description: 'Computer equipment purchase' },
                            { account: 'Accounts Payable', debit: 0, credit: 2500, description: 'Vendor payable' }
                        ],
                        status: 'Posted',
                        totalDebit: 2500,
                        totalCredit: 2500
                    }
                ];
                
                // Invoices
                this.state.invoices = [
                    { id: 1, vendor: 'Office Supplies Ltd', invoiceNo: 'INV-001', date: '2023-10-01', dueDate: '2023-10-31', amount: 1250.50, status: 'Pending' },
                    { id: 2, vendor: 'Tech Solutions Inc', invoiceNo: 'INV-002', date: '2023-10-05', dueDate: '2023-11-04', amount: 3500.00, status: 'Pending' },
                    { id: 3, vendor: 'Utilities Corp', invoiceNo: 'INV-003', date: '2023-09-25', dueDate: '2023-10-25', amount: 850.75, status: 'Overdue' }
                ];
                
                // Users
                this.state.users = [
                    { id: 1, userId: 'USR001', fullName: 'Admin User', email: 'admin@company.com', role: 'Administrator', department: 'Finance', lastLogin: '2023-10-31 09:15', status: 'Active' },
                    { id: 2, userId: 'USR002', fullName: 'John Smith', email: 'john.smith@company.com', role: 'Accountant', department: 'Finance', lastLogin: '2023-10-30 14:30', status: 'Active' }
                ];
                
                // Notifications
                this.state.notifications = [
                    { id: 1, title: 'Overdue Invoice', message: 'Invoice INV-003 is overdue by 5 days', type: 'warning', timestamp: '2023-10-26 10:30' },
                    { id: 2, title: 'Journal Posted', message: 'Journal entry JRNL-002 has been posted', type: 'info', timestamp: '2023-10-25 14:15' },
                    { id: 3, title: 'New User Added', message: 'New user John Smith has been added', type: 'success', timestamp: '2023-10-24 09:45' }
                ];
                
                this.saveToLocalStorage();
            }
            
            setupEventListeners() {
                // Sidebar navigation
                document.querySelectorAll('.sidebar-menu a').forEach(link => {
                    link.addEventListener('click', (e) => {
                        e.preventDefault();
                        const page = e.target.closest('a').getAttribute('data-page');
                        document.querySelectorAll('.sidebar-menu a').forEach(l => l.classList.remove('active'));
                        e.target.closest('a').classList.add('active');
                        this.showPage(page);
                    });
                });
                
                // Toggle sidebar
                document.getElementById('toggleSidebar').addEventListener('click', () => {
                    document.getElementById('sidebar').classList.toggle('active');
                });
                
                // Tab switching
                document.querySelectorAll('.tab').forEach(tab => {
                    tab.addEventListener('click', (e) => {
                        const tabId = e.target.getAttribute('data-tab');
                        const parent = e.target.closest('.module-section');
                        
                        parent.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
                        e.target.classList.add('active');
                        
                        parent.querySelectorAll('.tab-content').forEach(content => {
                            content.classList.remove('active');
                        });
                        
                        const tabContent = parent.querySelector(`#${tabId}Tab`);
                        if (tabContent) {
                            tabContent.classList.add('active');
                        }
                    });
                });
                
                // Close modals when clicking outside
                document.querySelectorAll('.modal').forEach(modal => {
                    modal.addEventListener('click', (e) => {
                        if (e.target === modal) {
                            this.closeModal(modal.id);
                        }
                    });
                });
                
                // Initialize date fields
                const today = new Date().toISOString().split('T')[0];
                document.getElementById('journalDate').value = today;
                document.getElementById('invoiceDate').value = today;
                document.getElementById('invoiceDueDate').value = this.addDays(today, 30);
            }
            
            // Utility Methods
            addDays(dateStr, days) {
                const date = new Date(dateStr);
                date.setDate(date.getDate() + days);
                return date.toISOString().split('T')[0];
            }
            
            formatCurrency(amount) {
                return new Intl.NumberFormat('en-US', {
                    style: 'currency',
                    currency: 'USD',
                    minimumFractionDigits: 2
                }).format(amount);
            }
            
            // Page Navigation
            showPage(page) {
                // Hide all pages
                document.querySelectorAll('.page-content').forEach(content => {
                    content.style.display = 'none';
                });
                
                // Show selected page
                const pageContent = document.getElementById(`${page}Content`);
                if (pageContent) {
                    pageContent.style.display = 'block';
                }
                
                // Update page title
                const pageTitles = {
                    'dashboard': 'Finance Dashboard',
                    'coa': 'Chart of Accounts',
                    'gl': 'General Ledger',
                    'ap': 'Accounts Payable',
                    'ar': 'Accounts Receivable',
                    'assets': 'Fixed Assets',
                    'bank': 'Bank & Reconciliation',
                    'budget': 'Budgeting',
                    'reports': 'Financial Reports',
                    'users': 'User Management',
                    'setup': 'Module Setup',
                    'comparison': 'Domain Comparison'
                };
                
                document.getElementById('pageTitle').textContent = pageTitles[page] || 'Finance Module';
                
                // Load page-specific data
                switch(page) {
                    case 'dashboard':
                        this.renderDashboard();
                        break;
                    case 'coa':
                        this.renderChartOfAccounts();
                        break;
                    case 'gl':
                        this.renderGeneralLedger();
                        break;
                    case 'ap':
                        this.renderAccountsPayable();
                        break;
                    case 'users':
                        this.renderUsers();
                        break;
                }
                
                // Close sidebar on mobile
                if (window.innerWidth <= 1200) {
                    document.getElementById('sidebar').classList.remove('active');
                }
            }
            
            // Modal Methods
            showModal(modalId) {
                const modal = document.getElementById(modalId);
                if (modal) {
                    modal.classList.add('active');
                    
                    if (modalId === 'journalEntryModal') {
                        this.populateJournalAccountDropdown();
                    }
                    
                    if (modalId === 'addAccountModal') {
                        this.populateParentAccounts();
                    }
                }
            }
            
            closeModal(modalId) {
                const modal = document.getElementById(modalId);
                if (modal) {
                    modal.classList.remove('active');
                    if (modalId === 'addAccountModal') {
                        document.getElementById('addAccountForm').reset();
                    }
                    if (modalId === 'journalEntryModal') {
                        document.getElementById('journalEntryForm').reset();
                        document.getElementById('journalLines').innerHTML = `
                            <div class="journal-line" style="display: flex; gap: 10px; margin-bottom: 15px; align-items: center;">
                                <select class="form-control" style="flex: 2;" onchange="erpSystem.updateAccountBalance(this)">
                                    <option value="">Select Account</option>
                                </select>
                                <input type="number" class="form-control" placeholder="Debit" style="flex: 1;" onchange="erpSystem.updateDebitCredit()" step="0.01">
                                <input type="number" class="form-control" placeholder="Credit" style="flex: 1;" onchange="erpSystem.updateDebitCredit()" step="0.01">
                                <input type="text" class="form-control" placeholder="Line Description" style="flex: 2;">
                                <button type="button" class="btn btn-danger btn-sm" onclick="erpSystem.removeJournalLine(this)"><i class="fas fa-times"></i></button>
                            </div>
                        `;
                    }
                }
            }
            
            // User Menu
            showUserMenu() {
                const menu = document.getElementById('userMenu');
                menu.style.display = menu.style.display === 'block' ? 'none' : 'block';
            }
            
            toggleNotifications() {
                const panel = document.getElementById('notificationsPanel');
                panel.style.display = panel.style.display === 'block' ? 'none' : 'block';
                if (panel.style.display === 'block') {
                    this.renderNotifications();
                }
            }
            
            clearAllNotifications() {
                this.state.notifications = [];
                this.saveToLocalStorage();
                this.renderNotifications();
                document.querySelector('.notification-badge').textContent = '0';
            }
            
            // Dashboard Methods
            renderDashboard() {
                // Update metrics
                document.getElementById('totalRevenue').textContent = this.formatCurrency(this.state.financialData.revenue);
                document.getElementById('totalAR').textContent = this.formatCurrency(this.state.financialData.accountsReceivable);
                document.getElementById('totalAP').textContent = this.formatCurrency(this.state.financialData.accountsPayable);
                document.getElementById('cashBalance').textContent = this.formatCurrency(this.state.financialData.cashBalance);
                
                // Render chart
                this.renderFinancialChart();
                
                // Render pending actions
                this.renderPendingActions();
                
                // Update notification badge
                document.querySelector('.notification-badge').textContent = this.state.notifications.length;
            }
            
            renderFinancialChart() {
                const ctx = document.getElementById('financialChart').getContext('2d');
                if (window.financialChart) {
                    window.financialChart.destroy();
                }
                
                window.financialChart = new Chart(ctx, {
                    type: 'line',
                    data: {
                        labels: ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct'],
                        datasets: [
                            {
                                label: 'Revenue',
                                data: [120, 190, 300, 500, 250, 400, 320, 480, 420, 450],
                                borderColor: '#2e7d32',
                                backgroundColor: 'rgba(46, 125, 50, 0.1)',
                                fill: true,
                                tension: 0.4
                            },
                            {
                                label: 'Expenses',
                                data: [80, 120, 200, 300, 180, 250, 280, 320, 300, 280],
                                borderColor: '#d32f2f',
                                backgroundColor: 'rgba(211, 47, 47, 0.1)',
                                fill: true,
                                tension: 0.4
                            }
                        ]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        plugins: {
                            legend: { position: 'top' }
                        },
                        scales: {
                            y: {
                                beginAtZero: true,
                                ticks: {
                                    callback: function(value) {
                                        return '$' + value + 'k';
                                    }
                                }
                            }
                        }
                    }
                });
            }
            
            renderPendingActions() {
                const table = document.getElementById('pendingActions');
                const actions = [
                    { action: 'Approve journal entries', module: 'General Ledger', priority: 'High', dueDate: 'Today', status: 'Pending' },
                    { action: 'Reconcile bank statement', module: 'Bank Reconciliation', priority: 'High', dueDate: 'Today', status: 'Pending' },
                    { action: 'Process vendor payments', module: 'Accounts Payable', priority: 'Medium', dueDate: 'Tomorrow', status: 'Pending' },
                    { action: 'Follow up on overdue invoices', module: 'Accounts Receivable', priority: 'Medium', dueDate: 'This week', status: 'Pending' }
                ];
                
                table.innerHTML = '';
                actions.forEach(action => {
                    const row = document.createElement('tr');
                    row.innerHTML = `
                        <td>${action.action}</td>
                        <td>${action.module}</td>
                        <td><span class="badge ${action.priority === 'High' ? 'badge-danger' : 'badge-warning'}">${action.priority}</span></td>
                        <td>${action.dueDate}</td>
                        <td><span class="badge badge-warning">${action.status}</span></td>
                        <td>
                            <button class="btn btn-sm btn-outline" onclick="erpSystem.completeAction('${action.action}')">
                                <i class="fas fa-check"></i> Complete
                            </button>
                        </td>
                    `;
                    table.appendChild(row);
                });
            }
            
            completeAction(actionName) {
                alert(`Action "${actionName}" marked as complete!`);
                this.renderPendingActions();
            }
            
            markAllComplete() {
                if (confirm('Mark all pending actions as complete?')) {
                    alert('All actions marked as complete!');
                    this.renderPendingActions();
                }
            }
            
            updateFinancialChart() {
                const period = document.getElementById('chartPeriod').value;
                alert(`Financial chart updated for period: ${period}`);
                this.renderFinancialChart();
            }
            
            // Chart of Accounts Methods
            renderChartOfAccounts() {
                this.renderCOATable();
                this.renderCOAHierarchy();
                this.renderCOABalances();
                this.renderCOAChart();
            }
            
            renderCOATable() {
                const table = document.getElementById('coaTable');
                table.innerHTML = '';
                
                this.state.chartOfAccounts.forEach(account => {
                    const row = document.createElement('tr');
                    row.innerHTML = `
                        <td><strong>${account.code}</strong></td>
                        <td>${account.name}</td>
                        <td><span class="badge ${this.getAccountTypeBadge(account.type)}">${account.type}</span></td>
                        <td>${account.subType || '-'}</td>
                        <td>${this.formatCurrency(account.balance)}</td>
                        <td><span class="badge ${account.status === 'Active' ? 'badge-success' : 'badge-danger'}">${account.status}</span></td>
                        <td>
                            <button class="btn btn-sm btn-outline" onclick="erpSystem.editAccount(${account.id})">
                                <i class="fas fa-edit"></i>
                            </button>
                            <button class="btn btn-sm btn-outline" onclick="erpSystem.toggleAccountStatus(${account.id})">
                                <i class="fas ${account.status === 'Active' ? 'fa-ban' : 'fa-check'}"></i>
                            </button>
                        </td>
                    `;
                    table.appendChild(row);
                });
            }
            
            getAccountTypeBadge(type) {
                const badges = {
                    'Asset': 'badge-primary',
                    'Liability': 'badge-warning',
                    'Equity': 'badge-success',
                    'Revenue': 'badge-info',
                    'Expense': 'badge-danger'
                };
                return badges[type] || 'badge-primary';
            }
            
            renderCOAHierarchy() {
                const container = document.getElementById('coaHierarchy');
                let html = '<div style="padding: 20px;">';
                
                // Group by type
                const grouped = {};
                this.state.chartOfAccounts.forEach(account => {
                    if (!grouped[account.type]) {
                        grouped[account.type] = [];
                    }
                    grouped[account.type].push(account);
                });
                
                Object.keys(grouped).forEach(type => {
                    html += `<div style="margin-bottom: 25px;">
                        <h4 style="color: var(--primary); margin-bottom: 10px;">
                            <i class="fas fa-folder"></i> ${type} Accounts
                        </h4>
                        <div style="margin-left: 20px;">`;
                    
                    grouped[type].forEach(account => {
                        html += `<div style="display: flex; align-items: center; padding: 8px 0; border-bottom: 1px solid #eee;">
                            <div style="width: 100px; font-weight: 600;">${account.code}</div>
                            <div style="flex: 1;">${account.name}</div>
                            <div style="width: 120px; text-align: right;">
                                ${this.formatCurrency(account.balance)}
                            </div>
                        </div>`;
                    });
                    
                    html += '</div></div>';
                });
                
                html += '</div>';
                container.innerHTML = html;
            }
            
            renderCOABalances() {
                const table = document.getElementById('coaBalancesTable');
                
                // Calculate totals by type
                const typeTotals = {};
                this.state.chartOfAccounts.forEach(account => {
                    if (!typeTotals[account.type]) {
                        typeTotals[account.type] = { count: 0, total: 0 };
                    }
                    typeTotals[account.type].count++;
                    typeTotals[account.type].total += account.balance;
                });
                
                const grandTotal = Object.values(typeTotals).reduce((sum, type) => sum + type.total, 0);
                
                table.innerHTML = '';
                Object.keys(typeTotals).forEach(type => {
                    const percentage = ((typeTotals[type].total / grandTotal) * 100).toFixed(1);
                    const row = document.createElement('tr');
                    row.innerHTML = `
                        <td>${type}</td>
                        <td>${typeTotals[type].count}</td>
                        <td>${this.formatCurrency(typeTotals[type].total)}</td>
                        <td>
                            <div style="display: flex; align-items: center;">
                                <div style="width: 100px; height: 8px; background: #eee; border-radius: 4px; margin-right: 10px;">
                                    <div style="width: ${percentage}%; height: 100%; background: var(--primary); border-radius: 4px;"></div>
                                </div>
                                ${percentage}%
                            </div>
                        </td>
                    `;
                    table.appendChild(row);
                });
            }
            
            renderCOAChart() {
                const ctx = document.getElementById('coaBalanceChart').getContext('2d');
                if (window.coaChart) {
                    window.coaChart.destroy();
                }
                
                // Calculate totals by type
                const typeTotals = {};
                this.state.chartOfAccounts.forEach(account => {
                    if (!typeTotals[account.type]) {
                        typeTotals[account.type] = 0;
                    }
                    typeTotals[account.type] += account.balance;
                });
                
                window.coaChart = new Chart(ctx, {
                    type: 'pie',
                    data: {
                        labels: Object.keys(typeTotals),
                        datasets: [{
                            data: Object.values(typeTotals),
                            backgroundColor: ['#3949ab', '#ff9800', '#2e7d32', '#d32f2f', '#0288d1'],
                            borderWidth: 1
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        plugins: {
                            legend: { position: 'right' }
                        }
                    }
                });
            }
            
            searchCOA() {
                const searchTerm = document.getElementById('coaSearch').value.toLowerCase();
                const rows = document.querySelectorAll('#coaTable tr');
                
                rows.forEach(row => {
                    const text = row.textContent.toLowerCase();
                    row.style.display = text.includes(searchTerm) ? '' : 'none';
                });
            }
            
            filterCOA() {
                const typeFilter = document.getElementById('coaTypeFilter').value;
                const statusFilter = document.getElementById('coaStatusFilter').value;
                const rows = document.querySelectorAll('#coaTable tr');
                
                rows.forEach(row => {
                    const cells = row.querySelectorAll('td');
                    if (cells.length < 6) return;
                    
                    const type = cells[2].textContent.trim();
                    const status = cells[5].textContent.trim();
                    
                    const typeMatch = typeFilter === 'all' || type === typeFilter;
                    const statusMatch = statusFilter === 'all' || status === statusFilter;
                    
                    row.style.display = typeMatch && statusMatch ? '' : 'none';
                });
            }
            
            populateParentAccounts() {
                const select = document.getElementById('parentAccount');
                select.innerHTML = '<option value="">No Parent (Top Level)</option>';
                this.state.chartOfAccounts.forEach(account => {
                    const option = document.createElement('option');
                    option.value = account.id;
                    option.textContent = `${account.code} - ${account.name}`;
                    select.appendChild(option);
                });
            }
            
            saveAccount() {
                const code = document.getElementById('accountCode').value;
                const name = document.getElementById('accountName').value;
                const type = document.getElementById('accountType').value;
                const balance = parseFloat(document.getElementById('accountBalance').value) || 0;
                
                if (!code || !name || !type) {
                    alert('Please fill in all required fields');
                    return;
                }
                
                const newAccount = {
                    id: this.state.chartOfAccounts.length + 1,
                    code: code,
                    name: name,
                    type: type,
                    subType: document.getElementById('accountSubType').value,
                    balance: balance,
                    currency: document.getElementById('accountCurrency').value,
                    status: document.getElementById('accountActive').checked ? 'Active' : 'Inactive',
                    description: document.getElementById('accountDescription').value,
                    parentId: document.getElementById('parentAccount').value || null
                };
                
                this.state.chartOfAccounts.push(newAccount);
                this.saveToLocalStorage();
                this.renderChartOfAccounts();
                this.closeModal('addAccountModal');
                alert('Account added successfully!');
            }
            
            editAccount(accountId) {
                const account = this.state.chartOfAccounts.find(acc => acc.id === accountId);
                if (!account) return;
                
                // Populate form
                document.getElementById('accountCode').value = account.code;
                document.getElementById('accountName').value = account.name;
                document.getElementById('accountType').value = account.type;
                document.getElementById('accountSubType').value = account.subType || '';
                document.getElementById('accountBalance').value = account.balance;
                document.getElementById('accountCurrency').value = account.currency || 'USD';
                document.getElementById('accountDescription').value = account.description || '';
                document.getElementById('accountActive').checked = account.status === 'Active';
                
                this.showModal('addAccountModal');
                
                // Change save button behavior
                const saveBtn = document.querySelector('#addAccountModal .btn-primary');
                saveBtn.textContent = 'Update Account';
                saveBtn.onclick = () => this.updateAccount(accountId);
            }
            
            updateAccount(accountId) {
                const accountIndex = this.state.chartOfAccounts.findIndex(acc => acc.id === accountId);
                if (accountIndex === -1) return;
                
                const code = document.getElementById('accountCode').value;
                const name = document.getElementById('accountName').value;
                const type = document.getElementById('accountType').value;
                const balance = parseFloat(document.getElementById('accountBalance').value) || 0;
                
                if (!code || !name || !type) {
                    alert('Please fill in all required fields');
                    return;
                }
                
                this.state.chartOfAccounts[accountIndex] = {
                    ...this.state.chartOfAccounts[accountIndex],
                    code: code,
                    name: name,
                    type: type,
                    subType: document.getElementById('accountSubType').value,
                    balance: balance,
                    currency: document.getElementById('accountCurrency').value,
                    status: document.getElementById('accountActive').checked ? 'Active' : 'Inactive',
                    description: document.getElementById('accountDescription').value,
                    parentId: document.getElementById('parentAccount').value || null
                };
                
                this.saveToLocalStorage();
                this.renderChartOfAccounts();
                this.closeModal('addAccountModal');
                
                // Reset button
                const saveBtn = document.querySelector('#addAccountModal .btn-primary');
                saveBtn.textContent = 'Save Account';
                saveBtn.onclick = () => this.saveAccount();
                
                alert('Account updated successfully!');
            }
            
            toggleAccountStatus(accountId) {
                const accountIndex = this.state.chartOfAccounts.findIndex(acc => acc.id === accountId);
                if (accountIndex === -1) return;
                
                const account = this.state.chartOfAccounts[accountIndex];
                const newStatus = account.status === 'Active' ? 'Inactive' : 'Active';
                
                if (confirm(`Are you sure you want to ${newStatus === 'Active' ? 'activate' : 'deactivate'} account ${account.code}?`)) {
                    this.state.chartOfAccounts[accountIndex].status = newStatus;
                    this.saveToLocalStorage();
                    this.renderChartOfAccounts();
                    alert(`Account ${newStatus === 'Active' ? 'activated' : 'deactivated'} successfully!`);
                }
            }
            
            exportCOA() {
                const dataStr = JSON.stringify(this.state.chartOfAccounts, null, 2);
                const dataUri = 'data:application/json;charset=utf-8,'+ encodeURIComponent(dataStr);
                const link = document.createElement('a');
                link.setAttribute('href', dataUri);
                link.setAttribute('download', 'chart_of_accounts.json');
                link.click();
                alert('Chart of Accounts exported successfully!');
            }
            
            loadSampleCOA() {
                if (confirm('Load sample chart of accounts? This will replace your current data.')) {
                    this.loadSampleData();
                    this.renderChartOfAccounts();
                    alert('Sample Chart of Accounts loaded successfully!');
                }
            }
            
            // General Ledger Methods
            renderGeneralLedger() {
                this.renderJournalTable();
                this.updateGLMetrics();
                this.renderTrialBalanceTable();
                this.renderTrialBalanceChart();
            }
            
            renderJournalTable() {
                const table = document.getElementById('journalTable');
                table.innerHTML = '';
                
                this.state.journalEntries.forEach(entry => {
                    const row = document.createElement('tr');
                    row.innerHTML = `
                        <td>${entry.date}</td>
                        <td><strong>${entry.journalNo}</strong></td>
                        <td>${entry.description}</td>
                        <td>${this.formatCurrency(entry.totalDebit)}</td>
                        <td>${this.formatCurrency(entry.totalCredit)}</td>
                        <td><span class="badge ${this.getJournalStatusBadge(entry.status)}">${entry.status}</span></td>
                        <td>
                            <button class="btn btn-sm btn-outline" onclick="erpSystem.viewJournalEntry(${entry.id})">
                                <i class="fas fa-eye"></i>
                            </button>
                            <button class="btn btn-sm btn-outline" onclick="erpSystem.postJournalEntry(${entry.id})" ${entry.status === 'Posted' ? 'disabled' : ''}>
                                <i class="fas fa-check"></i>
                            </button>
                        </td>
                    `;
                    table.appendChild(row);
                });
            }
            
            getJournalStatusBadge(status) {
                const badges = {
                    'Draft': 'badge-warning',
                    'Pending': 'badge-info',
                    'Posted': 'badge-success',
                    'Reversed': 'badge-danger'
                };
                return badges[status] || 'badge-primary';
            }
            
            updateGLMetrics() {
                const totalJournals = this.state.journalEntries.length;
                const unpostedJournals = this.state.journalEntries.filter(je => je.status !== 'Posted').length;
                
                let totalDebit = 0;
                let totalCredit = 0;
                this.state.journalEntries.forEach(entry => {
                    totalDebit += entry.totalDebit;
                    totalCredit += entry.totalCredit;
                });
                
                document.getElementById('totalJournals').textContent = totalJournals;
                document.getElementById('unpostedJournals').textContent = unpostedJournals;
                document.getElementById('monthJournals').textContent = this.state.journalEntries.filter(je => 
                    je.date.startsWith('2023-10')).length;
                document.getElementById('debitCreditBalance').textContent = 
                    `${this.formatCurrency(totalDebit)} / ${this.formatCurrency(totalCredit)}`;
            }
            
            populateJournalAccountDropdown() {
                const dropdowns = document.querySelectorAll('#journalLines select');
                dropdowns.forEach(dropdown => {
                    dropdown.innerHTML = '<option value="">Select Account</option>';
                    this.state.chartOfAccounts.forEach(account => {
                        if (account.status === 'Active') {
                            const option = document.createElement('option');
                            option.value = account.name;
                            option.textContent = `${account.code} - ${account.name}`;
                            dropdown.appendChild(option);
                        }
                    });
                });
            }
            
            addJournalLine() {
                const container = document.getElementById('journalLines');
                const lineDiv = document.createElement('div');
                lineDiv.className = 'journal-line';
                lineDiv.style.cssText = 'display: flex; gap: 10px; margin-bottom: 15px; align-items: center;';
                lineDiv.innerHTML = `
                    <select class="form-control" style="flex: 2;" onchange="erpSystem.updateAccountBalance(this)">
                        <option value="">Select Account</option>
                    </select>
                    <input type="number" class="form-control" placeholder="Debit" style="flex: 1;" onchange="erpSystem.updateDebitCredit()" step="0.01">
                    <input type="number" class="form-control" placeholder="Credit" style="flex: 1;" onchange="erpSystem.updateDebitCredit()" step="0.01">
                    <input type="text" class="form-control" placeholder="Line Description" style="flex: 2;">
                    <button type="button" class="btn btn-danger btn-sm" onclick="erpSystem.removeJournalLine(this)"><i class="fas fa-times"></i></button>
                `;
                container.appendChild(lineDiv);
                this.populateJournalAccountDropdown();
            }
            
            removeJournalLine(button) {
                button.parentElement.remove();
                this.updateDebitCredit();
            }
            
            updateDebitCredit() {
                const debitInputs = document.querySelectorAll('#journalLines input[placeholder="Debit"]');
                const creditInputs = document.querySelectorAll('#journalLines input[placeholder="Credit"]');
                
                let totalDebit = 0;
                let totalCredit = 0;
                
                debitInputs.forEach(input => {
                    totalDebit += parseFloat(input.value) || 0;
                });
                
                creditInputs.forEach(input => {
                    totalCredit += parseFloat(input.value) || 0;
                });
                
                const diff = totalDebit - totalCredit;
                
                document.getElementById('totalDebit').value = totalDebit.toFixed(2);
                document.getElementById('totalCredit').value = totalCredit.toFixed(2);
                document.getElementById('debitCreditDiff').value = diff.toFixed(2);
                
                const statusDiv = document.getElementById('balanceStatus');
                if (Math.abs(diff) < 0.01) {
                    statusDiv.innerHTML = '<span style="color: var(--success);"><i class="fas fa-check-circle"></i> Journal entry is balanced</span>';
                    statusDiv.style.display = 'block';
                    document.getElementById('debitCreditDiff').style.color = 'var(--success)';
                } else {
                    statusDiv.innerHTML = `<span style="color: var(--danger);"><i class="fas fa-exclamation-triangle"></i> Journal entry is unbalanced by ${Math.abs(diff).toFixed(2)}</span>`;
                    statusDiv.style.display = 'block';
                    document.getElementById('debitCreditDiff').style.color = 'var(--danger)';
                }
            }
            
            saveJournalEntry() {
                const date = document.getElementById('journalDate').value;
                const description = document.getElementById('journalDescription').value;
                
                if (!date || !description) {
                    alert('Please fill in all required fields');
                    return;
                }
                
                // Get journal lines
                const journalLines = document.querySelectorAll('#journalLines .journal-line');
                const lines = [];
                
                journalLines.forEach(line => {
                    const accountSelect = line.querySelector('select');
                    const debitInput = line.querySelector('input[placeholder="Debit"]');
                    const creditInput = line.querySelector('input[placeholder="Credit"]');
                    const lineDescInput = line.querySelector('input[placeholder="Line Description"]');
                    
                    if (accountSelect.value) {
                        const debit = parseFloat(debitInput.value) || 0;
                        const credit = parseFloat(creditInput.value) || 0;
                        
                        if (debit > 0 || credit > 0) {
                            lines.push({
                                account: accountSelect.value,
                                debit: debit,
                                credit: credit,
                                description: lineDescInput.value || ''
                            });
                        }
                    }
                });
                
                if (lines.length === 0) {
                    alert('Please add at least one journal line');
                    return;
                }
                
                // Check balance
                const totalDebit = lines.reduce((sum, line) => sum + line.debit, 0);
                const totalCredit = lines.reduce((sum, line) => sum + line.credit, 0);
                
                if (Math.abs(totalDebit - totalCredit) > 0.01) {
                    alert('Journal entry must balance. Debits must equal credits.');
                    return;
                }
                
                // Generate journal number
                const journalNo = 'JRNL-' + (this.state.journalEntries.length + 1001).toString().padStart(3, '0');
                
                const newEntry = {
                    id: this.state.journalEntries.length + 1,
                    date: date,
                    journalNo: journalNo,
                    description: description,
                    type: document.getElementById('journalType').value,
                    reference: document.getElementById('journalReference').value,
                    lines: lines,
                    status: 'Draft',
                    totalDebit: totalDebit,
                    totalCredit: totalCredit
                };
                
                this.state.journalEntries.push(newEntry);
                this.saveToLocalStorage();
                this.renderGeneralLedger();
                this.closeModal('journalEntryModal');
                alert('Journal entry saved successfully!');
            }
            
            viewJournalEntry(entryId) {
                const entry = this.state.journalEntries.find(je => je.id === entryId);
                if (!entry) return;
                
                let details = `<h3>Journal Entry Details</h3>
                    <p><strong>Journal No:</strong> ${entry.journalNo}</p>
                    <p><strong>Date:</strong> ${entry.date}</p>
                    <p><strong>Description:</strong> ${entry.description}</p>
                    <p><strong>Type:</strong> ${entry.type}</p>
                    <p><strong>Status:</strong> <span class="badge ${this.getJournalStatusBadge(entry.status)}">${entry.status}</span></p>
                    
                    <h4 style="margin-top: 20px;">Journal Lines</h4>
                    <table style="width: 100%; margin-top: 10px; border-collapse: collapse;">
                        <thead>
                            <tr style="background: #f8f9fa;">
                                <th style="padding: 10px; border: 1px solid #ddd;">Account</th>
                                <th style="padding: 10px; border: 1px solid #ddd;">Debit</th>
                                <th style="padding: 10px; border: 1px solid #ddd;">Credit</th>
                                <th style="padding: 10px; border: 1px solid #ddd;">Description</th>
                            </tr>
                        </thead>
                        <tbody>`;
                
                entry.lines.forEach(line => {
                    details += `<tr>
                        <td style="padding: 10px; border: 1px solid #ddd;">${line.account}</td>
                        <td style="padding: 10px; border: 1px solid #ddd;">${line.debit > 0 ? this.formatCurrency(line.debit) : '-'}</td>
                        <td style="padding: 10px; border: 1px solid #ddd;">${line.credit > 0 ? this.formatCurrency(line.credit) : '-'}</td>
                        <td style="padding: 10px; border: 1px solid #ddd;">${line.description}</td>
                    </tr>`;
                });
                
                details += `</tbody>
                    <tfoot>
                        <tr style="background: #f8f9fa;">
                            <th style="padding: 10px; border: 1px solid #ddd;">Total</th>
                            <th style="padding: 10px; border: 1px solid #ddd;">${this.formatCurrency(entry.totalDebit)}</th>
                            <th style="padding: 10px; border: 1px solid #ddd;">${this.formatCurrency(entry.totalCredit)}</th>
                            <th style="padding: 10px; border: 1px solid #ddd;"></th>
                        </tr>
                    </tfoot>
                </table>`;
                
                alert(details);
            }
            
            postJournalEntry(entryId) {
                const entryIndex = this.state.journalEntries.findIndex(je => je.id === entryId);
                if (entryIndex === -1) return;
                
                const entry = this.state.journalEntries[entryIndex];
                
                if (entry.status === 'Posted') {
                    alert('This journal entry is already posted.');
                    return;
                }
                
                if (confirm(`Post journal entry ${entry.journalNo}?`)) {
                    this.state.journalEntries[entryIndex].status = 'Posted';
                    
                    // Update account balances
                    entry.lines.forEach(line => {
                        const account = this.state.chartOfAccounts.find(acc => acc.name === line.account);
                        if (account) {
                            if (line.debit > 0) {
                                if (account.type === 'Asset' || account.type === 'Expense') {
                                    account.balance += line.debit;
                                } else {
                                    account.balance -= line.debit;
                                }
                            }
                            if (line.credit > 0) {
                                if (account.type === 'Asset' || account.type === 'Expense') {
                                    account.balance -= line.credit;
                                } else {
                                    account.balance += line.credit;
                                }
                            }
                        }
                    });
                    
                    this.saveToLocalStorage();
                    this.renderGeneralLedger();
                    this.renderChartOfAccounts();
                    this.renderDashboard();
                    
                    // Add notification
                    this.state.notifications.push({
                        id: this.state.notifications.length + 1,
                        title: 'Journal Posted',
                        message: `Journal entry ${entry.journalNo} has been posted`,
                        type: 'info',
                        timestamp: new Date().toLocaleString()
                    });
                    
                    this.saveToLocalStorage();
                    alert('Journal entry posted successfully!');
                }
            }
            
            postAllEntries() {
                const unpostedEntries = this.state.journalEntries.filter(je => je.status !== 'Posted');
                
                if (unpostedEntries.length === 0) {
                    alert('No unposted journal entries found.');
                    return;
                }
                
                if (confirm(`Post all ${unpostedEntries.length} unposted journal entries?`)) {
                    unpostedEntries.forEach(entry => {
                        const entryIndex = this.state.journalEntries.findIndex(je => je.id === entry.id);
                        if (entryIndex !== -1) {
                            this.state.journalEntries[entryIndex].status = 'Posted';
                            
                            // Update account balances
                            entry.lines.forEach(line => {
                                const account = this.state.chartOfAccounts.find(acc => acc.name === line.account);
                                if (account) {
                                    if (line.debit > 0) {
                                        if (account.type === 'Asset' || account.type === 'Expense') {
                                            account.balance += line.debit;
                                        } else {
                                            account.balance -= line.debit;
                                        }
                                    }
                                    if (line.credit > 0) {
                                        if (account.type === 'Asset' || account.type === 'Expense') {
                                            account.balance -= line.credit;
                                        } else {
                                            account.balance += line.credit;
                                        }
                                    }
                                }
                            });
                        }
                    });
                    
                    this.saveToLocalStorage();
                    this.renderGeneralLedger();
                    this.renderChartOfAccounts();
                    this.renderDashboard();
                    alert(`Successfully posted ${unpostedEntries.length} journal entries!`);
                }
            }
            
            runMonthEndClose() {
                if (confirm('Run month-end closing process? This will close all open periods.')) {
                    alert('Month-end closing process completed successfully!');
                }
            }
            
            renderTrialBalanceTable() {
                const table = document.getElementById('trialBalanceTable');
                table.innerHTML = '';
                
                this.state.chartOfAccounts.forEach(account => {
                    let debitBalance = 0;
                    let creditBalance = 0;
                    let netBalance = 0;
                    
                    if (account.type === 'Asset' || account.type === 'Expense') {
                        debitBalance = account.balance;
                        netBalance = account.balance;
                    } else {
                        creditBalance = account.balance;
                        netBalance = -account.balance;
                    }
                    
                    const row = document.createElement('tr');
                    row.innerHTML = `
                        <td>${account.code}</td>
                        <td>${account.name}</td>
                        <td>${debitBalance > 0 ? this.formatCurrency(debitBalance) : '-'}</td>
                        <td>${creditBalance > 0 ? this.formatCurrency(creditBalance) : '-'}</td>
                        <td><strong>${this.formatCurrency(netBalance)}</strong></td>
                    `;
                    table.appendChild(row);
                });
            }
            
            renderTrialBalanceChart() {
                const ctx = document.getElementById('trialBalanceChart').getContext('2d');
                if (window.trialBalanceChart) {
                    window.trialBalanceChart.destroy();
                }
                
                // Calculate trial balance data
                const assetAccounts = this.state.chartOfAccounts.filter(acc => acc.type === 'Asset');
                const liabilityAccounts = this.state.chartOfAccounts.filter(acc => acc.type === 'Liability');
                const equityAccounts = this.state.chartOfAccounts.filter(acc => acc.type === 'Equity');
                
                const assetTotal = assetAccounts.reduce((sum, acc) => sum + acc.balance, 0);
                const liabilityTotal = liabilityAccounts.reduce((sum, acc) => sum + acc.balance, 0);
                const equityTotal = equityAccounts.reduce((sum, acc) => sum + acc.balance, 0);
                
                window.trialBalanceChart = new Chart(ctx, {
                    type: 'bar',
                    data: {
                        labels: ['Assets', 'Liabilities', 'Equity'],
                        datasets: [{
                            label: 'Account Balances',
                            data: [assetTotal, liabilityTotal, equityTotal],
                            backgroundColor: ['#3949ab', '#ff9800', '#2e7d32']
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        plugins: {
                            legend: { display: false }
                        },
                        scales: {
                            y: {
                                beginAtZero: true,
                                ticks: {
                                    callback: function(value) {
                                        return '$' + value.toLocaleString();
                                    }
                                }
                            }
                        }
                    }
                });
            }
            
            searchJournals() {
                const searchTerm = document.getElementById('journalSearch').value.toLowerCase();
                const rows = document.querySelectorAll('#journalTable tr');
                
                rows.forEach(row => {
                    const text = row.textContent.toLowerCase();
                    row.style.display = text.includes(searchTerm) ? '' : 'none';
                });
            }
            
            filterJournals() {
                const statusFilter = document.getElementById('journalStatusFilter').value;
                const dateFilter = document.getElementById('journalDateFilter').value;
                const rows = document.querySelectorAll('#journalTable tr');
                
                rows.forEach(row => {
                    const cells = row.querySelectorAll('td');
                    if (cells.length < 6) return;
                    
                    const date = cells[0].textContent.trim();
                    const status = cells[5].textContent.trim();
                    
                    const statusMatch = statusFilter === 'all' || status === statusFilter;
                    const dateMatch = !dateFilter || date === dateFilter;
                    
                    row.style.display = statusMatch && dateMatch ? '' : 'none';
                });
            }
            
            // Accounts Payable Methods
            renderAccountsPayable() {
                this.renderAPTable();
                this.updateAPMetrics();
            }
            
            renderAPTable() {
                const table = document.getElementById('apTable');
                table.innerHTML = '';
                
                this.state.invoices.forEach(invoice => {
                    const today = new Date();
                    const dueDate = new Date(invoice.dueDate);
                    const status = invoice.status === 'Overdue' ? 'Overdue' : 
                                  dueDate < today ? 'Overdue' : invoice.status;
                    
                    const row = document.createElement('tr');
                    row.innerHTML = `
                        <td>${invoice.vendor}</td>
                        <td>${invoice.invoiceNo}</td>
                        <td>${invoice.date}</td>
                        <td>${invoice.dueDate}</td>
                        <td>${this.formatCurrency(invoice.amount)}</td>
                        <td><span class="badge ${status === 'Overdue' ? 'badge-danger' : 'badge-warning'}">${status}</span></td>
                        <td>
                            <button class="btn btn-sm btn-outline" onclick="erpSystem.payInvoice(${invoice.id})">
                                <i class="fas fa-money-bill-wave"></i>
                            </button>
                            <button class="btn btn-sm btn-outline" onclick="erpSystem.viewInvoice(${invoice.id})">
                                <i class="fas fa-eye"></i>
                            </button>
                        </td>
                    `;
                    table.appendChild(row);
                });
            }
            
            updateAPMetrics() {
                const totalDue = this.state.invoices.reduce((sum, inv) => sum + inv.amount, 0);
                const overdue = this.state.invoices.filter(inv => {
                    const dueDate = new Date(inv.dueDate);
                    return dueDate < new Date();
                }).reduce((sum, inv) => sum + inv.amount, 0);
                
                document.getElementById('apTotalDue').textContent = totalDue.toLocaleString();
                document.getElementById('apOverdue').textContent = overdue.toLocaleString();
                document.getElementById('apDueThisWeek').textContent = (totalDue * 0.4).toLocaleString();
                document.getElementById('apVendorCount').textContent = '3';
            }
            
            saveInvoice() {
                const vendor = document.getElementById('invoiceVendor').value;
                const invoiceNo = document.getElementById('invoiceNumber').value;
                const amount = parseFloat(document.getElementById('invoiceAmount').value);
                
                if (!vendor || !invoiceNo || !amount) {
                    alert('Please fill in all required fields');
                    return;
                }
                
                const newInvoice = {
                    id: this.state.invoices.length + 1,
                    vendor: vendor,
                    invoiceNo: invoiceNo,
                    date: document.getElementById('invoiceDate').value,
                    dueDate: document.getElementById('invoiceDueDate').value,
                    amount: amount,
                    description: document.getElementById('invoiceDescription').value,
                    account: document.getElementById('invoiceAccount').value,
                    status: 'Pending'
                };
                
                this.state.invoices.push(newInvoice);
                this.saveToLocalStorage();
                this.renderAccountsPayable();
                this.closeModal('addInvoiceModal');
                alert('Invoice added successfully!');
            }
            
            payInvoice(invoiceId) {
                const invoice = this.state.invoices.find(inv => inv.id === invoiceId);
                if (!invoice) return;
                
                if (confirm(`Pay invoice ${invoice.invoiceNo} for ${this.formatCurrency(invoice.amount)}?`)) {
                    invoice.status = 'Paid';
                    this.saveToLocalStorage();
                    this.renderAccountsPayable();
                    alert('Invoice paid successfully!');
                }
            }
            
            viewInvoice(invoiceId) {
                const invoice = this.state.invoices.find(inv => inv.id === invoiceId);
                if (!invoice) return;
                
                alert(`Invoice Details:\n\nVendor: ${invoice.vendor}\nInvoice No: ${invoice.invoiceNo}\nDate: ${invoice.date}\nDue Date: ${invoice.dueDate}\nAmount: ${this.formatCurrency(invoice.amount)}\nStatus: ${invoice.status}`);
            }
            
            searchAP() {
                const searchTerm = document.getElementById('apSearch').value.toLowerCase();
                const rows = document.querySelectorAll('#apTable tr');
                
                rows.forEach(row => {
                    const text = row.textContent.toLowerCase();
                    row.style.display = text.includes(searchTerm) ? '' : 'none';
                });
            }
            
            filterAP() {
                const statusFilter = document.getElementById('apStatusFilter').value;
                const rows = document.querySelectorAll('#apTable tr');
                
                rows.forEach(row => {
                    const cells = row.querySelectorAll('td');
                    if (cells.length < 6) return;
                    
                    const status = cells[5].textContent.trim();
                    const statusMatch = statusFilter === 'all' || status === statusFilter;
                    
                    row.style.display = statusMatch ? '' : 'none';
                });
            }
            
            processBatchPayments() {
                if (confirm('Process batch payments for all pending invoices?')) {
                    alert('Batch payment processing completed!');
                }
            }
            
            exportAPData() {
                alert('AP data exported successfully!');
            }
            
            // User Management Methods
            renderUsers() {
                const table = document.getElementById('usersTable');
                table.innerHTML = '';
                
                this.state.users.forEach(user => {
                    const row = document.createElement('tr');
                    row.innerHTML = `
                        <td><strong>${user.userId}</strong></td>
                        <td>${user.fullName}</td>
                        <td>${user.email}</td>
                        <td><span class="badge badge-primary">${user.role}</span></td>
                        <td>${user.department}</td>
                        <td>${user.lastLogin}</td>
                        <td><span class="badge ${user.status === 'Active' ? 'badge-success' : 'badge-danger'}">${user.status}</span></td>
                        <td>
                            <button class="btn btn-sm btn-outline" onclick="erpSystem.editUser(${user.id})">
                                <i class="fas fa-edit"></i>
                            </button>
                            <button class="btn btn-sm btn-outline" onclick="erpSystem.toggleUserStatus(${user.id})">
                                <i class="fas ${user.status === 'Active' ? 'fa-user-slash' : 'fa-user-check'}"></i>
                            </button>
                        </td>
                    `;
                    table.appendChild(row);
                });
                
                // Update user counts
                document.getElementById('totalUsers').textContent = this.state.users.length;
                document.getElementById('activeUsers').textContent = this.state.users.filter(u => u.status === 'Active').length;
                document.getElementById('inactiveUsers').textContent = this.state.users.filter(u => u.status !== 'Active').length;
                document.getElementById('userRolesCount').textContent = '4';
            }
            
            addUser() {
                alert('Add User functionality would open a modal here.');
            }
            
            editUser(userId) {
                alert(`Edit user ${userId} functionality would open a modal here.`);
            }
            
            toggleUserStatus(userId) {
                const userIndex = this.state.users.findIndex(u => u.id === userId);
                if (userIndex === -1) return;
                
                const user = this.state.users[userIndex];
                const newStatus = user.status === 'Active' ? 'Inactive' : 'Active';
                
                if (confirm(`Are you sure you want to ${newStatus === 'Active' ? 'activate' : 'deactivate'} user ${user.fullName}?`)) {
                    this.state.users[userIndex].status = newStatus;
                    this.saveToLocalStorage();
                    this.renderUsers();
                    alert(`User ${newStatus === 'Active' ? 'activated' : 'deactivated'} successfully!`);
                }
            }
            
            manageRoles() {
                alert('Manage Roles functionality would open a modal here.');
            }
            
            auditLogs() {
                alert('Audit Logs functionality would open a modal here.');
            }
            
            // Notifications Methods
            renderNotifications() {
                const list = document.getElementById('notificationsList');
                list.innerHTML = '';
                
                if (this.state.notifications.length === 0) {
                    list.innerHTML = '<p style="text-align: center; color: #666; padding: 20px;">No notifications</p>';
                    return;
                }
                
                this.state.notifications.forEach(notification => {
                    const div = document.createElement('div');
                    div.style.cssText = 'padding: 12px; border-bottom: 1px solid #eee;';
                    div.innerHTML = `
                        <div style="display: flex; justify-content: space-between;">
                            <strong style="color: #333;">${notification.title}</strong>
                            <small style="color: #999;">${notification.timestamp}</small>
                        </div>
                        <div style="margin-top: 5px; color: #666;">${notification.message}</div>
                    `;
                    list.appendChild(div);
                });
            }
            
            // Domain Methods
            changeDomain(domain) {
                this.state.currentDomain = domain;
                this.saveToLocalStorage();
                this.updateDomainBadge();
            }
            
            updateDomainBadge() {
                const domainLabels = {
                    'general': 'General Business',
                    'hotel': 'Hotel Industry',
                    'education': 'Education Sector',
                    'banking': 'Banking',
                    'manufacturing': 'Manufacturing'
                };
                document.getElementById('domainBadge').textContent = domainLabels[this.state.currentDomain] || 'General Business';
            }
            
            showDomainDetails(domain) {
                const details = {
                    hotel: {
                        title: 'Hotel Industry - Finance Configuration',
                        content: `
                            <div class="bank-card">
                                <h4>Key Features:</h4>
                                <ul>
                                    <li><strong>Revenue Recognition:</strong> Daily room revenue, event bookings</li>
                                    <li><strong>Chart of Accounts:</strong> Departmental (rooms, F&B, events)</li>
                                    <li><strong>AP Focus:</strong> Many small vendors (suppliers, services)</li>
                                    <li><strong>AR Complexity:</strong> Mostly credit cards, corporate accounts</li>
                                </ul>
                            </div>
                        `
                    },
                    education: {
                        title: 'Education Sector - Finance Configuration',
                        content: `
                            <div class="bank-card">
                                <h4>Key Features:</h4>
                                <ul>
                                    <li><strong>Revenue Recognition:</strong> Tuition fees, grants, research funds</li>
                                    <li><strong>Chart of Accounts:</strong> Fund accounting, grants, research</li>
                                    <li><strong>AP Focus:</strong> Faculty payments, infrastructure</li>
                                    <li><strong>AR Complexity:</strong> Student accounts, sponsorships</li>
                                </ul>
                            </div>
                        `
                    },
                    banking: {
                        title: 'Banking - Finance Configuration',
                        content: `
                            <div class="bank-card">
                                <h4>Key Features:</h4>
                                <ul>
                                    <li><strong>Revenue Recognition:</strong> Interest income, fees, commissions</li>
                                    <li><strong>Chart of Accounts:</strong> Regulatory structure, provisions</li>
                                    <li><strong>AP Focus:</strong> Few large vendors, interbank</li>
                                    <li><strong>AR Complexity:</strong> Loan repayments, fee collection</li>
                                </ul>
                            </div>
                        `
                    },
                    manufacturing: {
                        title: 'Manufacturing - Finance Configuration',
                        content: `
                            <div class="bank-card">
                                <h4>Key Features:</h4>
                                <ul>
                                    <li><strong>Revenue Recognition:</strong> Product sales, service contracts</li>
                                    <li><strong>Chart of Accounts:</strong> Cost centers by product line</li>
                                    <li><strong>AP Focus:</strong> Raw material suppliers, MRO</li>
                                    <li><strong>AR Complexity:</strong> Customer invoices, milestones</li>
                                </ul>
                            </div>
                        `
                    }
                };
                
                const domainInfo = details[domain];
                if (!domainInfo) return;
                
                document.getElementById('domainDetailsTitle').textContent = domainInfo.title;
                document.getElementById('domainDetailsContent').innerHTML = domainInfo.content;
                document.getElementById('domainDetails').style.display = 'block';
            }
            
            applyDomainSettings(domain) {
                this.state.currentDomain = domain;
                document.getElementById('domainSelector').value = domain;
                this.updateDomainBadge();
                this.saveToLocalStorage();
                alert(`Domain settings for ${domain} applied successfully!`);
            }
            
            // Other Module Methods (simplified)
            addFixedAsset() {
                alert('Add Fixed Asset functionality would open a modal here.');
            }
            
            runDepreciation() {
                alert('Depreciation run successfully for all fixed assets.');
            }
            
            exportAssets() {
                alert('Fixed Assets exported successfully!');
            }
            
            addBankAccount() {
                alert('Add Bank Account functionality would open a modal here.');
            }
            
            importBankStatement() {
                alert('Bank statement import functionality.');
            }
            
            reconcileAccount() {
                alert('Account reconciliation started.');
            }
            
            createBudget() {
                alert('Create Budget functionality would open a modal here.');
            }
            
            copyBudget() {
                alert('Budget copied from previous period.');
            }
            
            analyzeVariance() {
                alert('Variance analysis completed.');
            }
            
            generateFinancialStatement(type) {
                alert(`Generating ${type} report...`);
            }
            
            downloadReport(type) {
                alert(`Downloading ${type} report...`);
            }
            
            viewReport(type) {
                alert(`Viewing ${type} report...`);
            }
            
            saveSetup() {
                alert('Setup settings saved successfully!');
            }
            
            testConnection() {
                alert('Connection test successful!');
            }
            
            backupConfig() {
                alert('Configuration backup completed!');
            }
        }

        // Initialize the ERP System
        const erpSystem = new ERPFinanceSystem();

        // Global functions for inline event handlers
        function showModal(modalId) {
            erpSystem.showModal(modalId);
        }
        
        function closeModal(modalId) {
            erpSystem.closeModal(modalId);
        }
        
        function showUserMenu() {
            erpSystem.showUserMenu();
        }
        
        function toggleNotifications() {
            erpSystem.toggleNotifications();
        }
        
        function changeDomain(domain) {
            erpSystem.changeDomain(domain);
        }
        
        function addJournalLine() {
            erpSystem.addJournalLine();
        }
        
        function removeJournalLine(button) {
            erpSystem.removeJournalLine(button);
        }
        
        function updateDebitCredit() {
            erpSystem.updateDebitCredit();
        }
        
        function saveAccount() {
            erpSystem.saveAccount();
        }
        
        function saveJournalEntry() {
            erpSystem.saveJournalEntry();
        }
        
        function saveInvoice() {
            erpSystem.saveInvoice();
        }
        
        function markAllComplete() {
            erpSystem.markAllComplete();
        }
        
        function completeAction(action) {
            erpSystem.completeAction(action);
        }
        
        function updateFinancialChart() {
            erpSystem.updateFinancialChart();
        }
        
        function searchCOA() {
            erpSystem.searchCOA();
        }
        
        function filterCOA() {
            erpSystem.filterCOA();
        }
        
        function exportCOA() {
            erpSystem.exportCOA();
        }
        
        function loadSampleCOA() {
            erpSystem.loadSampleCOA();
        }
        
        function postAllEntries() {
            erpSystem.postAllEntries();
        }
        
        function runMonthEndClose() {
            erpSystem.runMonthEndClose();
        }
        
        function searchJournals() {
            erpSystem.searchJournals();
        }
        
        function filterJournals() {
            erpSystem.filterJournals();
        }
        
        function searchAP() {
            erpSystem.searchAP();
        }
        
        function filterAP() {
            erpSystem.filterAP();
        }
        
        function processBatchPayments() {
            erpSystem.processBatchPayments();
        }
        
        function exportAPData() {
            erpSystem.exportAPData();
        }
        
        function showDomainDetails(domain) {
            erpSystem.showDomainDetails(domain);
        }
        
        function applyDomainSettings(domain) {
            erpSystem.applyDomainSettings(domain);
        }
        
        // Add click outside handlers
        document.addEventListener('click', (e) => {
            const userMenu = document.getElementById('userMenu');
            const userProfile = document.querySelector('.user-profile');
            if (userMenu && userProfile && !userMenu.contains(e.target) && !userProfile.contains(e.target)) {
                userMenu.style.display = 'none';
            }
            
            const notificationsPanel = document.getElementById('notificationsPanel');
            const notificationBell = document.querySelector('.notification');
            if (notificationsPanel && notificationBell && !notificationsPanel.contains(e.target) && !notificationBell.contains(e.target)) {
                notificationsPanel.style.display = 'none';
            }
        });

        // Close sidebar on mobile when clicking outside
        document.addEventListener('click', (e) => {
            const sidebar = document.getElementById('sidebar');
            const toggleBtn = document.getElementById('toggleSidebar');
            if (window.innerWidth <= 1200 && sidebar.classList.contains('active') && 
                !sidebar.contains(e.target) && !toggleBtn.contains(e.target)) {
                sidebar.classList.remove('active');
            }
        });

        // Initialize with current date
        document.getElementById('journalDate').value = new Date().toISOString().split('T')[0];
        document.getElementById('invoiceDate').value = new Date().toISOString().split('T')[0];
        const dueDate = new Date();
        dueDate.setDate(dueDate.getDate() + 30);
        document.getElementById('invoiceDueDate').value = dueDate.toISOString().split('T')[0];
    </script>
</body>
</html>